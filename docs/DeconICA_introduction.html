<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Urszula Czerwinska" />

<meta name="date" content="2018-05-03" />

<title>Introduction to deconICA</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color: initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link rel="stylesheet" href="DeconICA_introduction_files/style.css" type="text/css" />

</head>

<body>




<section class="page-header">
<h1 class="title toc-ignore project-name">Introduction to deconICA</h1>
<h3 class="subtitle project-tagline">Deconvolution of transcriptome through Immune Component Analysis</h3>
<h4 class="author project-author">Urszula Czerwinska</h4>
<h4 class="date project-date">2018-05-03</h4>
</section>


<div id="TOC" class="toc">
<ul>
<li><a href="#background">Background</a><ul>
<li><a href="#blind-source-separation">Blind source separation</a></li>
<li><a href="#application-of-bss-to-biological-data">Application of BSS to biological data</a><ul>
<li><a href="#independent-components-analysis">Independent Components Analysis</a></li>
<li><a href="#nmf">NMF</a></li>
<li><a href="#convex-hull-methods">Convex hull methods</a></li>
<li><a href="#attractor-metagenes">Attractor metagenes</a></li>
</ul></li>
</ul></li>
<li><a href="#Tut">Tutorial</a><ul>
<li><a href="#how-to-install">How to install</a></li>
<li><a href="#cases">Demonstration of DeconICA package</a><ul>
<li><a href="#simulated-data">Simulated data</a></li>
<li><a href="#in-vitro-mixtures-of-immune-cells"><em>in vitro</em> mixtures of immune cells</a></li>
<li><a href="#blood-data-paired-with-facs-estimated-proportions">Blood data paired with FACS estimated proportions</a></li>
</ul></li>
<li><a href="#overview-of-functions">Overview of functions</a><ul>
<li><a href="#full-pipeline-example">Full pipeline example</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul></li>
</ul>
</div>

<section class="main-content">
<div style="float:left;position: relative; top: -3px; left: -2px;">
<p><img src="figures-ext/deconicalogo.png" width="210.4688" height="192.1875" /></p>
</div>
<p>This is an introduction to the <a href="https://github.com/UrszulaCzerwinska/DeconICA"><code>deconICA</code></a> R package.</p>
<p><strong>DeconICA</strong> stands for <strong>Deconvolution of transcriptome through Immune Component Analysis</strong>.</p>
<p>The aim of the project is to adapt blind source separation techniques to extract immune-related signals from mixed biological samples. A great example of mixed biological sample is transcriptome measured in heterogenous tissue such as blood or tumor biopsy.</p>
<p>In this vignette we present short introduction to the blind source spearation techniques, the biological foundation of the problem and finally we walk you through examples on how to use <a href="https://github.com/UrszulaCzerwinska/DeconICA"><code>deconICA</code></a> R package.</p>
<p>If you are interested only in practical examples of <a href="https://github.com/UrszulaCzerwinska/DeconICA"><code>deconICA</code></a>, skip directly to <a href="#Tut">Tutorial</a> section.</p>
<p>You can access this documentation on the <a href="https://urszulaczerwinska.github.io/DeconICA/">DeconICA website</a>.</p>
<div id="background" class="section level1">
<h1>Background</h1>
<div id="blind-source-separation" class="section level2">
<h2>Blind source separation</h2>
<p>Blind source separation (BSS) is the separation of a set of source signals from a set of mixed signals, without the aid of information (or with very little information) about the source signals or the mixing process. The separation is possible under a variety of conditions.</p>
<p>A known example of BSS is a <strong>cocktail party problem</strong>, there is a group of people talking at the same time. You have multiple microphones picking up mixed signals, but you want to isolate the speech of a single person. BSS can be used to separate the individual sources by using mixed signals <span class="citation">(Hyv√§rinen and Oja 2000)</span></p>
</div>
<div id="application-of-bss-to-biological-data" class="section level2">
<h2>Application of BSS to biological data</h2>
<p>Through decomposition of the transcriptome matrix into components (aka factors or sources) we hope to recover underlying biological functions and cell types.</p>
<p>In tumor biopsies is it expected to find a part of Tumor Microenvironment (TME). TME includes tumor cells, fibroblasts, and a diversity of immune cells. Most studies have focused on individual cell types in model tumor systems, and/or on individual molecules mediating a crosstalk between two cells. Unraveling the complexity, organization, and mutual interactions of TME cellular components represents a major challenge.</p>
<p>Several methods have been proposed to estimate the mixing proportions of sources in biological mixtures, such as: least squares regression <span class="citation">(Abbas et al. 2009)</span> and more recently, non-negative least squares regression [Qiao2012], quadratic programming [Gong2011] and supported vector regression <span class="citation">(Newman et al. 2015)</span>. Even though <span class="citation">(Vallania et al. 2017)</span> shows that the used algorithm do not impact substantially the results. According to <span class="citation">Vallania et al. (2017)</span>, what matters are the gene signatures used as an input of aforementioned methods.</p>
<p><strong>BSS methods do not use pre-defined cell-type signatures</strong>. The transcriptomic matrix is decomposed into a certain number of sources and then the sources are interpreted with available knowledge (gene signatures, cell profiles).</p>
<p>The main argument of using BSS over supervised decomposition techniques is that the obtained result is <strong>unbiased</strong> by <em>a priori</em> biological hypothesis (however there are always statistical hypothesis about the nature of data) or knowledge. In addition BSS techniques allow <strong>discovery</strong> of new biological signatures that can extend our available knowledge.</p>
<p>In the case of cell type separation from mix of tumor bulk, supervised techniques as CIBERSORT <span class="citation">(Newman et al. 2015)</span>, MCP counter <span class="citation">(Becht et al. 2016, <span class="citation">Becht and de Reynies (2016)</span>)</span>, TIMER <span class="citation">(Li et al. 2016)</span> etc. are based on optimized blood signatures. With an evidence brought by single cell data, these signatures are not always characterizing immune cells infiltrating tumors <span class="citation">(Schelker et al. 2017)</span>. Some methods, like EPIC <span class="citation">(Racle et al. 2017)</span>, use single-cell based signatures. However, today, the single cell based signatures are limited to few cancer subtypes and often based on small number of patients, incomparable with the heterogeneity that is hidden in the bulk transcriptome cohort studies.</p>
<p>Therefore, obtaining informative cell-type signature of immune cells infiltrating tumor biopsy samples at high thoughput remains an open question that we attempt to approach with <code>deconICA</code> pipeline.</p>
<p>Here is a short overview of BSS or related algorithms that one can potentially use as an input to <code>deconICA</code>. At its actual state <code>deconICA</code> facilitates starting pipeline with ICA.</p>
<div class="figure" style="text-align: center">
<img src="figures-ext/methodsBSS.png" alt="**Graphical representation of dimension reduction &amp; BSS methods.** PCA, ICA, NMF inspired by figures of Andrei Zinovyev, Convex hull: CC BY [@Wang2016]" width="976px" height="267.5px" />
<p class="caption">
<strong>Graphical representation of dimension reduction &amp; BSS methods.</strong> PCA, ICA, NMF inspired by figures of Andrei Zinovyev, Convex hull: CC BY <span class="citation">(Wang et al. 2016)</span>
</p>
</div>
<div id="independent-components-analysis" class="section level3">
<h3>Independent Components Analysis</h3>
<p>Independent Component Analysis (ICA) is a matrix factorization method for data dimension reduction <span class="citation">(Hyv√§rinen and Oja 2000)</span>. ICA defines a new coordinate system in the multi-dimensional space such that the distributions of the data point projections on the new axes become as mutually independent as possible. To achieve this, the standard approach is maximizing the non-gaussianity of the data point projection distributions <span class="citation">(Hyv√§rinen and Oja 2000)</span>. There is no constraint imposed on the non-negativity (in contrary to NMF) or orthogonality (in contrast to PCA). In our analysis, the negative projections are interpreted in terms of absolute values and only one side of a component is taken into account.</p>
<p>A mathematical way to formalize ICA is the set of equations:</p>
<p>the set of individual source signals <span class="math inline">\(s(t) = (s_{1}(t), ..., s_{n}(t))^T\)</span> is mixed using a matrix <span class="math inline">\(A = [a_{ij}] \in \mathbb{R}^{m \times n}\)</span> to produce a set of mixed signals, <span class="math inline">\(x(t) = (x_{1}(t), ..., x_{m}(t))^T\)</span>, as follows:</p>
<p><span class="math display">\[x(t) = A \times s(t)\]</span></p>
<p>The above equation is effectively ‚Äòinverted‚Äô as follows. Blind source separation separates the set of mixed signals <span class="math inline">\(x(t)\)</span>, through the determination of an ‚Äòunmixing‚Äô matrix to <span class="math inline">\(B = [b_{ij}] \in \mathbb{R}^{m \times n}\)</span> ‚Äòrecover‚Äô an approximation of the original signals, <span class="math inline">\(y(t) = (y_{1}(t), ..., y_{n}(t))^T\)</span>.</p>
<p><span class="math display">\[y(t) = B \times x(t)\]</span></p>
<p>This algorithm uses higher-order moments for matrix approximation, considering all Gaussian signals as noise.</p>
<p>Most efficient application of ICA is fastICA <span class="citation">(Hyv√§rinen and Oja 2000)</span>. However, the speed comes with a price, the results of the algorithms are not exact. This is why we recommend use of ICA with stabilization (ICASSO <span class="citation">(Himberg and Hyv√§rinen 2003)</span>) for reproducible results. More about this is the vignette <a href="Icasso.html">Running fastICA with icasso stabilisation</a>.</p>
<p>For applications in molecular biology, Independent Component Analysis (ICA) models gene expression data as an action of a set of statistically independent hidden factors.</p>
<p>Here is a small list of ICA application to biological data:</p>
<ul>
<li>Independent component analysis uncovers the landscape of the bladder tumor transcriptome and reveals insights into luminal and basal subtypes <span class="citation">(Biton et al. 2014)</span></li>
<li>Elucidating the altered transcriptional programs in breast cancer using independent component analysis <span class="citation">(Teschendorff et al. 2007)</span></li>
<li>Principal Manifolds for Data Visualization and Dimension Reduction <span class="citation">(Gorban, A.N., K√©gl, B., Wunsch, D.C., Zinovyev 2008)</span></li>
<li>Independent component analysis of microarray data in the study of endometrial cancer <span class="citation">(Saidi et al. 2004)</span></li>
<li>Blind source separation methods for deconvolution of complex signals in cancer biology <span class="citation">(Zinovyev et al. 2013)</span></li>
<li>Determining the optimal number of independent components for reproducible transcriptomic data analysis <span class="citation">(Kairov et al. 2017)</span></li>
<li>Application of Independent Component Analysis to Tumor Transcriptomes Reveals Specific And Reproducible Immune-related Signals <span class="citation">(Czerwinska et al. 2018)</span></li>
</ul>
</div>
<div id="nmf" class="section level3">
<h3>NMF</h3>
<p>Non-negative matrix factorization (NMF) is matrix factorization technique assuming that the mixing, source and mixed matrices are all non negative. It is usually written as</p>
<p><span class="math display">\[V = WH\]</span></p>
<p>Matrix multiplication can be implemented as computing the column vectors of <span class="math inline">\(V\)</span> as linear combinations of the column vectors in <span class="math inline">\(W\)</span> using coefficients supplied by columns of <span class="math inline">\(H\)</span>. That is, each column of <span class="math inline">\(V\)</span> can be computed as follows:</p>
<p><span class="math display">\[{v}_{i}={W}{h}_{i}\]</span></p>
<p>where <span class="math inline">\(v_{i}\)</span> is the <span class="math inline">\(i\)</span>-th column vector of the product matrix <span class="math inline">\(V\)</span> and <span class="math inline">\(h_{i}\)</span> is the <span class="math inline">\(i\)</span>-th column vector of the matrix <span class="math inline">\(H\)</span>.</p>
<p>There are many types of NMF, that differ in implementation, ways the error terms are defined and minimized.</p>
<p><span class="citation">Gaujoux and Seoighe (2012)</span> proposed a framework of semi-supervised NMF for solving cell and tissue mixtures in his R package <em>CellMix</em> <span class="citation">(Gaujoux and Seoighe 2013)</span>. His work deconvolution was of great inspiration for us and food for thoughts on the advantages and limits of BBS applied for cell type deconvolution.</p>
<p>Renaud Gaujoux is also an author of NMF R package <span class="citation">(Gaujoux and Seoighe 2010; Gaujoux and Seoighe 2015b; Gaujoux and Seoighe 2015a)</span>.</p>
<p>Work of Cantini et al. (<span class="citation">(<span class="citeproc-not-found" data-reference-id="Cantini2018"><strong>???</strong></span>)</span>) showed that ICA produces more reproducible results than NMF when applied to tumor transcriptomes.</p>
<p>However, we can always imagine the cases where NMF factorisation will be judged more adequate than ICA. Our pipeline is adaptable to interpretation of NMF factors without a need for major adjustments. We will be seen extend vignettes to show application of deconICA for interpretation of NMF components.</p>
<p>Here is a small list of NMF application to biological data:</p>
<ul>
<li>Metagenes and molecular pattern discovery using matrix factorization <span class="citation">(Brunet et al. 2004)</span></li>
<li>Tumor Clustering Using Nonnegative Matrix Factorization With Gene Selection <span class="citation">(Chun-Hou Zheng et al. 2009)</span></li>
<li>Semi-supervised Nonnegative Matrix Factorization for gene expression deconvolution: a case study <span class="citation">(Gaujoux and Seoighe 2012)</span></li>
<li>Post‚Äêmodified non‚Äênegative matrix factorization for deconvoluting the gene expression profiles of specific cell types from heterogeneous clinical samples based on RNA‚Äêsequencing data <span class="citation">(Liu et al. 2017)</span></li>
<li>Virtual microdissection identifies distinct tumor- and stroma-specific subtypes of pancreatic ductal adenocarcinoma <span class="citation">(Moffitt et al. 2015)</span></li>
<li>A non-negative matrix factorization method for detecting modules in heterogeneous omics multi-modal data <span class="citation">(Yang and Michailidis 2015)</span></li>
</ul>
</div>
<div id="convex-hull-methods" class="section level3">
<h3>Convex hull methods</h3>
<p>An emerging family of BSS methods are convex geometry (CG)-based methods. Here, the ‚Äúsources‚Äù are found by searching the facets of the convex hull spanned by the mapped observations solving a classical convex optimization problem <span class="citation">(Yang and Michailidis 2015)</span>. The convex hull-based method does not require the independence assumption, nor the non-correlation assumption which can be interesting in the setup of closely related cell types. <span class="citation">Wang et al. (2016)</span> apply their method of convex analysis of mixtures (CAM) to tissue and cell mixtures claiming to provide new signatures. So far the published R-Java package does not allow to extract those signtures and it is not scalable to tumor transcriptomes. Another tool CellDistinguisher <span class="citation">(Newberg et al. 2018)</span> provides an <a href="https://github.com/GeneralElectric/CellDistinguisher">user-friendly R package</a>. However, authors do not provide any method for estimation of number of sources. Additionally, quantitative weights are provided only for signature genes which number can vary for different sources. They do not apply their algorithm to complex mixtures as tumor transcriptome.</p>
<p>However, combining convex hull methods and <code>deconICA</code>can possibly lead to a meaningful interpretation.</p>
<p>Here is a small list of convex-hull application to biological data:</p>
<ul>
<li>Computational de novo discovery of distinguishing genes for biological processes and cell types in complex tissues [Newberg2018]</li>
<li>Mathematical modelling of transcriptional heterogeneity identifies novel markers and subpopulations in complex tissues <span class="citation">(Wang et al. 2016)</span></li>
<li>Geometry of the Gene Expression Space of Individual Cells <span class="citation">(Yang and Michailidis 2015)</span></li>
<li>Applying unmixing to gene expression data for tumor phylogeny inference <span class="citation">(Schwartz and Shackney 2010)</span></li>
<li>Inferring biological tasks using Pareto analysis of high-dimensional data <span class="citation">(Hart et al. 2015)</span></li>
</ul>
</div>
<div id="attractor-metagenes" class="section level3">
<h3>Attractor metagenes</h3>
<p>Another way of generating signatures, that can be run in semi-supervised or unsupervised mode is attractor metagenes method proposed by <span class="citation">Cheng, Ou Yang, and Anastassiou (2013)</span>. Authors describe their rationale as follows:</p>
<blockquote>
<p>We can first define a consensus metagene from the average expression levels of all genes in the cluster, and rank all the individual genes in terms of their association (defined numerically by some form of correlation) with that metagene. We can then replace the member genes of the cluster with an equal number of the top-ranked genes. Some of the original genes may naturally remain as members of the cluster, but some may be replaced, as this process will ‚Äúattract‚Äù some other genes that are more strongly correlated with the cluster. We can now define a new metagene defined by the average expression levels of the genes in the newly defined cluster, and re-rank all the individual genes in terms of their association with that new metagene; and so on. It is intuitively reasonable to expect that this iterative process will eventually converge to a cluster that contains precisely the genes that are most associated with the metagene of the same cluster, so that any other individual genes will be less strongly associated with the metagene. We can think of this particular cluster defined by the convergence of this iterative process as an ‚Äúattractor‚Äù i.e., a module of co-expressed genes to which many other gene sets with close but not identical membership will converge using the same computational methodology.</p>
</blockquote>
<p>The produced signatures‚Äô weights are non-negative. In the original paper, the generation of tumor signatures leads to three reproducible signatures among different tumor types. Typically with the essential parmeter <span class="math inline">\(\alpha = 5\)</span>, they discovered typically approximately 50 to 150 resulting attractors. Although, it is possible by tuninig <span class="math inline">\(\alpha\)</span> obtain more or less signatures that would be possibly interpretable with <code>deconICA</code>.</p>
<p>Attractor metagenes R code is available on <a href="https://www.synapse.org/#!Synapse:syn1446295">Synapse portal</a>.</p>
<p>Literature:</p>
<ul>
<li>Biomolecular Events in Cancer Revealed by Attractor Metagenes <span class="citation">(Cheng, Ou Yang, and Anastassiou 2013)</span></li>
<li>Discovering Genome-Wide Tag SNPs Based on the Mutual Information of the Variants <span class="citation">(Elmas et al. 2016)</span></li>
<li>Meta-analysis of the global gene expression profile of triple-negative breast cancer identifies genes for the prognostication and treatment of aggressive breast cancer <span class="citation">(Al-Ejeh et al. 2014)</span></li>
</ul>
</div>
</div>
</div>
<div id="Tut" class="section level1">
<h1>Tutorial</h1>
<div id="how-to-install" class="section level2">
<h2>How to install</h2>
<p>You can install <code>deconICA</code> from GitHub with:</p>
<pre class="sourceCode r" id="cb1"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#install.packages(&quot;devtools&quot;)</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;UrszulaCzerwinska/DeconICA&quot;</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre>
<p>or</p>
<pre class="sourceCode r" id="cb2"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;githubinstall&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">githubinstall<span class="op">::</span><span class="kw">githubinstall</span>(<span class="st">&quot;DeconICA&quot;</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre>
<p>[<strong>TO DO</strong>] You can install the stable version from <a href="https://cran.r-project.org/web/packages/deconica/index.html">CRAN</a></p>
<pre class="sourceCode r" id="cb3"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&#39;deconica&#39;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</a></code></pre>
<p>Then load package with</p>
<pre class="sourceCode r" id="cb4"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(deconica)</a></code></pre>
</div>
<div id="cases" class="section level2">
<h2>Demonstration of DeconICA package</h2>
<div id="simulated-data" class="section level3">
<h3>Simulated data</h3>
<p>At first, we asses an ability to estimate abundance of cell types in a synthetic cell mixture. Here we use function <code>simulate_gene_expresssion()</code>inspired by <code>CellMix::rmix</code> function. However, compared to <code>rmix</code> function cell profiles distribution follow user defined distribution (uniform in <code>rmix</code>) set here by default to negative binomial which approaches the biological reality.</p>
<p>First we create the <em>mix1</em> that is a mix of 10 cell types mixed at random proportions. Obatained matrix has 10000 genes and 130 samples. Each cell type has 20 specific markers with 2-fold difference with respect to other genes.</p>
<pre class="sourceCode r" id="cb5"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">mix1&lt;-<span class="kw">simulate_gene_expresssion</span>(<span class="dv">10</span>, <span class="dv">10000</span>, <span class="dv">130</span>,<span class="dv">0</span>, <span class="dt">markers=</span><span class="dv">20</span>)</a></code></pre>
<p>We can visualize the mixed expression matrix.</p>
<pre class="sourceCode r" id="cb6"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(mix1<span class="op">$</span>expression)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-9-1.png" /><!-- --> We can also visualize the <em>purified gene expression</em> of each cell.</p>
<pre class="sourceCode r" id="cb7"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(mix1<span class="op">$</span>basis_matrix)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-10-1.png" /><!-- --></p>
<p>Then we apply ICA (matlab version with stabilisation see <a href="Icasso.html">vignette: Running fastICA with icasso stabilisation</a>) and we decompose to 11 components. If you don‚Äôt have file you can find in <code>data-vignettes</code> the file <code>mix1_ica.RData</code>.</p>
<pre class="sourceCode r" id="cb8"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">mix1_ica &lt;-<span class="st"> </span><span class="kw">run_fastica</span> (</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  mix1<span class="op">$</span>expression,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="dt">overdecompose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  <span class="dt">with.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  <span class="dt">gene.names =</span> <span class="kw">row.names</span>(mix1<span class="op">$</span>expression),</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">  <span class="dt">samples =</span> <span class="kw">colnames</span>(mix1<span class="op">$</span>expression),</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  <span class="dt">n.comp =</span> <span class="dv">11</span>,</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">  <span class="dt">R =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">)</a></code></pre>
<p>Subsequently, we compute correlation between components and the original cell profiles.</p>
<pre class="sourceCode r" id="cb9"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">basis.list &lt;-<span class="st"> </span><span class="kw">make_list</span>(mix1<span class="op">$</span>basis_matrix)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">mix1_corr.basis &lt;-</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw">correlate_metagenes</span> (mix1_ica<span class="op">$</span>S, mix1_ica<span class="op">$</span>names, </a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                       <span class="dt">metagenes =</span> basis.list,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                       <span class="dt">orient.long =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">                       <span class="dt">orient.max =</span> <span class="ot">FALSE</span>)</a></code></pre>
<pre class="sourceCode r" id="cb10"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">mix1_corr.basis_p &lt;-<span class="st"> </span><span class="kw">radar_plot_corr</span>(mix1_corr.basis, <span class="dt">size.el.txt =</span> <span class="dv">10</span>, <span class="dt">point.size =</span> <span class="dv">2</span>)</a></code></pre>
<pre class="sourceCode r" id="cb11"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">mix1_corr.basis_p<span class="op">$</span>p</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p>
<p>We automatically assign a component to a cell type.</p>
<pre class="sourceCode r" id="cb12"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">mix1.assign &lt;-<span class="st"> </span><span class="kw">assign_metagenes</span>(mix1_corr.basis<span class="op">$</span>r, <span class="dt">exclude_name =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; no profiles to exlude provided</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; DONE</span></a></code></pre>
<p>We use top 10 genes as signatures.</p>
<pre class="sourceCode r" id="cb13"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">mix1_ica<span class="fl">.10</span> &lt;-</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw">generate_markers</span>(mix1_ica, <span class="dv">10</span>,  <span class="dt">sel.comp =</span> <span class="kw">as.character</span>(mix1.assign[, <span class="dv">2</span>]))</a></code></pre>
<p>It is possible to visualize <em>the basis matrix</em> as a heatmap</p>
<pre class="sourceCode r" id="cb14"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">mix1_ica.<span class="fl">10.</span>basis &lt;-</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">generate_basis</span>(</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">    <span class="dt">df =</span> mix1_ica,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">    <span class="dt">sel.comp =</span> <span class="kw">as.character</span>(mix1.assign[,<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">    <span class="dt">markers =</span> mix1_ica<span class="fl">.10</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">  )</a></code></pre>
<pre class="sourceCode r" id="cb15"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(mix1_ica.<span class="fl">10.</span>basis, <span class="dt">fontsize_row =</span> <span class="dv">8</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-19-1.png" /><!-- --></p>
<p>We compute scores which are by default simple mean value of expression of the top genes in the original gene matrix.</p>
<pre class="sourceCode r" id="cb16"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">scores.mix1.ica &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">get_scores</span>(mix1_ica<span class="op">$</span>log.counts, mix1_ica<span class="fl">.10</span>)</a></code></pre>
<p>We can see on the correlation plot almost prefect correspondence with the original proportions (<code>mix1$prop</code>)</p>
<pre class="sourceCode r" id="cb17"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">scores_corr_plot</span>(scores.mix1.ica,<span class="kw">t</span>(mix1<span class="op">$</span>prop),  <span class="dt">method=</span><span class="st">&quot;number&quot;</span>,  <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-23-1.png" /><!-- --></p>
<p>One important feature of the ICA is that even if we do not know the exact number of components, when we overestimate the number of components, the signals are not altered. Our team proposed a method called MSTD that was developed for cancer transcriptomes to estimate optimal number of components <span class="citation">(Kairov et al. 2017)</span>. Here we just slightly overestimate the number of components to 20.</p>
<p>Again you can load the decompostion <code>mix1_ica.20.RData</code> from <code>data-vignettes</code>repository of the package</p>
<pre class="sourceCode r" id="cb18"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">mix1_ica<span class="fl">.20</span> &lt;-<span class="st"> </span><span class="kw">run_fastica</span> (</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  mix1<span class="op">$</span>expression,</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="dt">overdecompose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="dt">with.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  <span class="dt">gene.names =</span> <span class="kw">row.names</span>(mix1<span class="op">$</span>expression),</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">  <span class="dt">n.comp =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">  <span class="dt">R =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8">  )</a></code></pre>
<p>Then we repeat the pipeline‚Ä¶</p>
<pre class="sourceCode r" id="cb19"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">mix1_corr.basis<span class="fl">.20</span> &lt;-</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw">correlate_metagenes</span> (</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">    mix1_ica<span class="fl">.20</span><span class="op">$</span>S,</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">    mix1_ica<span class="fl">.20</span><span class="op">$</span>names,</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">    <span class="dt">metagenes =</span> basis.list,</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">    <span class="dt">orient.long =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">    <span class="dt">orient.max =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">mix1_corr.basis<span class="fl">.20</span>_p &lt;-<span class="st"> </span><span class="kw">radar_plot_corr</span>(mix1_corr.basis<span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb19-10" data-line-number="10">                <span class="dt">size.el.txt =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">                <span class="dt">point.size =</span> <span class="dv">2</span>)</a></code></pre>
<pre class="sourceCode r" id="cb20"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">mix1_corr.basis<span class="fl">.20</span>_p<span class="op">$</span>p</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-27-1.png" /><!-- --></p>
<pre class="sourceCode r" id="cb21"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">mix1.assign<span class="fl">.20</span> &lt;-<span class="st"> </span><span class="kw">assign_metagenes</span>(mix1_corr.basis<span class="fl">.20</span><span class="op">$</span>r, <span class="dt">exclude_name =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co">#&gt; no profiles to exlude provided</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#&gt; DONE</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">mix1_ica<span class="fl">.20</span><span class="op">$</span>S &lt;-<span class="st"> </span>mix1_corr.basis<span class="fl">.20</span><span class="op">$</span>S.max</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">mix1_ica<span class="fl">.20</span>_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">generate_markers</span>(mix1_ica<span class="fl">.20</span>, <span class="dv">10</span>,  <span class="dt">sel.comp =</span> <span class="kw">as.character</span>(mix1.assign<span class="fl">.20</span>[,<span class="dv">2</span>]),  <span class="dt">orient.long =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">scores.mix1.ica<span class="fl">.20</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="st">  </span><span class="kw">get_scores</span>(mix1_ica<span class="fl">.20</span><span class="op">$</span>log.counts, mix1_ica<span class="fl">.20</span>_<span class="dv">10</span>)</a></code></pre>
<pre class="sourceCode r" id="cb22"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">scores_corr_plot</span>(scores.mix1.ica<span class="fl">.20</span>,<span class="kw">t</span>(mix1<span class="op">$</span>prop),  <span class="dt">method=</span><span class="st">&quot;number&quot;</span>,  <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-31-1.png" /><!-- --></p>
<p>And we observe that the estimated proportions are correctly estimated.</p>
</div>
<div id="in-vitro-mixtures-of-immune-cells" class="section level3">
<h3><em>in vitro</em> mixtures of immune cells</h3>
<p>In this demo we use data published in (<span class="citation">(Becht et al. 2016)</span>)[<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE64385" class="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE64385</a>] <code>GSE54385</code>that you can download yourself directly from GEO using following lines of code.</p>
<pre class="sourceCode r" id="cb23"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">library</span>(Biobase)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">library</span>(GEOquery)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="kw">library</span>(limma)</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co"># load series and platform data from GEO</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6">GSE64385 &lt;-<span class="st"> </span><span class="kw">getGEO</span>(<span class="st">&quot;GSE64385&quot;</span>, <span class="dt">GSEMatrix =</span><span class="ot">TRUE</span>, <span class="dt">AnnotGPL=</span><span class="ot">TRUE</span>)[[<span class="dv">1</span>]]</a></code></pre>
<p>Or you can load <code>GSE64385.RData</code> from <code>data-vignettes</code> repo.</p>
<p>This dataset contains 5 immune cell types sorted from 3 healthy donors‚Äô peripheral bloods and mixed at different proportions.</p>
<pre class="sourceCode r" id="cb24"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">exprs</span>(GSE64385))</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#&gt;           GSM1570043 GSM1570044 GSM1570045 GSM1570046 GSM1570047</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt; 1007_s_at  10.102138  10.155999   8.791912   8.896220   9.191570</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt; 1053_at     9.228374   9.106643   7.905549   7.872256   8.001900</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt; 117_at      4.965703   5.244713   9.161352   8.624783  10.440195</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt; 121_at      7.096468   7.140063   6.914336   6.887061   6.759080</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">#&gt; 1255_g_at   3.722354   3.781077   3.591351   3.532078   3.573182</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">#&gt; 1294_at     6.785320   6.971410   9.331253   9.294259   9.130948</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">#&gt;           GSM1570048 GSM1570049 GSM1570050 GSM1570051 GSM1570052</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">#&gt; 1007_s_at   8.755960   8.739414   8.913141   9.065699   8.678224</span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">#&gt; 1053_at     7.660617   7.698507   8.052159   7.792194   7.491376</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">#&gt; 117_at      9.682815   9.989239   9.024631   9.806865  10.208413</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">#&gt; 121_at      6.880957   6.839934   6.845430   6.906710   6.694776</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="co">#&gt; 1255_g_at   3.678108   3.520875   3.661857   3.572804   3.578966</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="co">#&gt; 1294_at     9.370041   9.351603   9.296094   9.372588   9.021147</span></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"><span class="co">#&gt;           GSM1570053 GSM1570054</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17"><span class="co">#&gt; 1007_s_at   8.683351   8.856388</span></a>
<a class="sourceLine" id="cb24-18" data-line-number="18"><span class="co">#&gt; 1053_at     7.742929   8.002106</span></a>
<a class="sourceLine" id="cb24-19" data-line-number="19"><span class="co">#&gt; 117_at      8.861634   9.842995</span></a>
<a class="sourceLine" id="cb24-20" data-line-number="20"><span class="co">#&gt; 121_at      7.050564   6.920022</span></a>
<a class="sourceLine" id="cb24-21" data-line-number="21"><span class="co">#&gt; 1255_g_at   3.585279   3.631184</span></a>
<a class="sourceLine" id="cb24-22" data-line-number="22"><span class="co">#&gt; 1294_at     9.417215   9.277763</span></a></code></pre>
<p>Here is the raw matrix of proportions.</p>
<pre class="sourceCode r" id="cb25"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">cell_prop &lt;-<span class="st"> </span><span class="kw">pData</span>(GSE64385)[ , <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">11</span>,<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>)]</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw">kable</span>(cell_prop, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:left;">
geo_accession
</th>
<th style="text-align:left;">
characteristics_ch1
</th>
<th style="text-align:left;">
characteristics_ch1.1
</th>
<th style="text-align:left;">
characteristics_ch1.2
</th>
<th style="text-align:left;">
characteristics_ch1.3
</th>
<th style="text-align:left;">
characteristics_ch1.4
</th>
<th style="text-align:left;">
characteristics_ch1.5
</th>
<th style="text-align:left;">
characteristics_ch1.6
</th>
<th style="text-align:left;">
characteristics_ch1.7
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GSM1570043
</td>
<td style="text-align:left;">
Mix_1
</td>
<td style="text-align:left;">
GSM1570043
</td>
<td style="text-align:left;">
cell line: HCT116
</td>
<td style="text-align:left;">
cell line type: colon cancer
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 0
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 0
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 0
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 0
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570044
</td>
<td style="text-align:left;">
Mix_2
</td>
<td style="text-align:left;">
GSM1570044
</td>
<td style="text-align:left;">
cell line: HCT116
</td>
<td style="text-align:left;">
cell line type: colon cancer
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 0
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 0
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 0
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 0
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570045
</td>
<td style="text-align:left;">
Mix_3
</td>
<td style="text-align:left;">
GSM1570045
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 10
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 0.3
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 5
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570046
</td>
<td style="text-align:left;">
Mix_4
</td>
<td style="text-align:left;">
GSM1570046
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 5
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 10
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 0.2
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570047
</td>
<td style="text-align:left;">
Mix_5
</td>
<td style="text-align:left;">
GSM1570047
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 5
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570048
</td>
<td style="text-align:left;">
Mix_6
</td>
<td style="text-align:left;">
GSM1570048
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 10
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570049
</td>
<td style="text-align:left;">
Mix_7
</td>
<td style="text-align:left;">
GSM1570049
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 5
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 10
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570050
</td>
<td style="text-align:left;">
Mix_8
</td>
<td style="text-align:left;">
GSM1570050
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 10
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 5
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570051
</td>
<td style="text-align:left;">
Mix_9
</td>
<td style="text-align:left;">
GSM1570051
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 10
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570052
</td>
<td style="text-align:left;">
Mix_10
</td>
<td style="text-align:left;">
GSM1570052
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 5
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570053
</td>
<td style="text-align:left;">
Mix_11
</td>
<td style="text-align:left;">
GSM1570053
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 1.3
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 0.2
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 10
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 5
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570054
</td>
<td style="text-align:left;">
Mix_12
</td>
<td style="text-align:left;">
GSM1570054
</td>
<td style="text-align:left;">
cell populations: HCT116, NK, B, neutrophils, T, monocytes
</td>
<td style="text-align:left;">
hct116 mrna mass (ng): 10
</td>
<td style="text-align:left;">
nk cells mrna mass (ng): 5
</td>
<td style="text-align:left;">
b cells mrna mass (ng): 2.5
</td>
<td style="text-align:left;">
neutrophils mrna mass (ng): 0.3
</td>
<td style="text-align:left;">
t cells mrna mass (ng): 0.6
</td>
<td style="text-align:left;">
monocytes mrna mass (ng): 10
</td>
<td style="text-align:left;">
disease status of blood donor: healthy
</td>
</tr>
</tbody>
</table>
<p>We manually extracted the immune cell proportions from the matrix</p>
<pre class="sourceCode r" id="cb26"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">cell_prop.clean &lt;-<span class="st"> </span>cell_prop [,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">cell_prop.clean<span class="op">$</span>NK &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="fl">2.5</span>, <span class="fl">1.3</span>, <span class="fl">0.6</span>, <span class="dv">10</span>, <span class="fl">0.6</span>, <span class="fl">1.3</span>, <span class="fl">2.5</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">cell_prop.clean<span class="op">$</span>Bcell &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="fl">0.6</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="fl">2.5</span>, <span class="fl">1.3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="fl">0.6</span>, <span class="fl">1.3</span>,<span class="fl">2.5</span>)</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">cell_prop.clean<span class="op">$</span>Neutrophils &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">2.5</span>, <span class="fl">1.3</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">1.3</span>, <span class="fl">2.5</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span> )</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">cell_prop.clean<span class="op">$</span>Tcell &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">2.5</span>, <span class="fl">1.3</span>, <span class="fl">0.6</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="fl">1.3</span>, <span class="fl">2.5</span>, <span class="dv">5</span>,<span class="dv">10</span>,<span class="fl">0.6</span> )</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">cell_prop.clean<span class="op">$</span>Monocytes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">2.5</span>, <span class="fl">1.3</span>, <span class="fl">0.6</span>, <span class="dv">10</span>, <span class="fl">0.6</span>, <span class="fl">1.3</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="kw">kable</span>(cell_prop.clean, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:left;">
geo_accession
</th>
<th style="text-align:right;">
NK
</th>
<th style="text-align:right;">
Bcell
</th>
<th style="text-align:right;">
Neutrophils
</th>
<th style="text-align:right;">
Tcell
</th>
<th style="text-align:right;">
Monocytes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GSM1570043
</td>
<td style="text-align:left;">
Mix_1
</td>
<td style="text-align:left;">
GSM1570043
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570044
</td>
<td style="text-align:left;">
Mix_2
</td>
<td style="text-align:left;">
GSM1570044
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570045
</td>
<td style="text-align:left;">
Mix_3
</td>
<td style="text-align:left;">
GSM1570045
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
5.0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570046
</td>
<td style="text-align:left;">
Mix_4
</td>
<td style="text-align:left;">
GSM1570046
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
2.5
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570047
</td>
<td style="text-align:left;">
Mix_5
</td>
<td style="text-align:left;">
GSM1570047
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
1.3
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570048
</td>
<td style="text-align:left;">
Mix_6
</td>
<td style="text-align:left;">
GSM1570048
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
0.6
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570049
</td>
<td style="text-align:left;">
Mix_7
</td>
<td style="text-align:left;">
GSM1570049
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
10.0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570050
</td>
<td style="text-align:left;">
Mix_8
</td>
<td style="text-align:left;">
GSM1570050
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.6
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570051
</td>
<td style="text-align:left;">
Mix_9
</td>
<td style="text-align:left;">
GSM1570051
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
1.3
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570052
</td>
<td style="text-align:left;">
Mix_10
</td>
<td style="text-align:left;">
GSM1570052
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
2.5
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570053
</td>
<td style="text-align:left;">
Mix_11
</td>
<td style="text-align:left;">
GSM1570053
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
5.0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570054
</td>
<td style="text-align:left;">
Mix_12
</td>
<td style="text-align:left;">
GSM1570054
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
10.0
</td>
</tr>
</tbody>
</table>
<p>Then we scaled them to relative proportions.</p>
<pre class="sourceCode r" id="cb27"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">rowSums</span>(cell_prop.clean[, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>])</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="co">#&gt; GSM1570043 GSM1570044 GSM1570045 GSM1570046 GSM1570047 GSM1570048 </span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">#&gt;        0.0        0.0       18.4       19.0       11.9       15.7 </span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">#&gt; GSM1570049 GSM1570050 GSM1570051 GSM1570052 GSM1570053 GSM1570054 </span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">#&gt;       17.5       17.5       15.7       11.9       19.0       18.4</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6">cell_prop.clean.scaled &lt;-</a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="st">  </span>cell_prop.clean[, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>] <span class="op">/</span><span class="st"> </span><span class="kw">rowSums</span>(cell_prop.clean[, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>])</a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="kw">kable</span>(cell_prop.clean.scaled, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
NK
</th>
<th style="text-align:right;">
Bcell
</th>
<th style="text-align:right;">
Neutrophils
</th>
<th style="text-align:right;">
Tcell
</th>
<th style="text-align:right;">
Monocytes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GSM1570043
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570044
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570045
</td>
<td style="text-align:right;">
0.5434783
</td>
<td style="text-align:right;">
0.0326087
</td>
<td style="text-align:right;">
0.0163043
</td>
<td style="text-align:right;">
0.1358696
</td>
<td style="text-align:right;">
0.2717391
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570046
</td>
<td style="text-align:right;">
0.2631579
</td>
<td style="text-align:right;">
0.5263158
</td>
<td style="text-align:right;">
0.0105263
</td>
<td style="text-align:right;">
0.0684211
</td>
<td style="text-align:right;">
0.1315789
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570047
</td>
<td style="text-align:right;">
0.2100840
</td>
<td style="text-align:right;">
0.4201681
</td>
<td style="text-align:right;">
0.2100840
</td>
<td style="text-align:right;">
0.0504202
</td>
<td style="text-align:right;">
0.1092437
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570048
</td>
<td style="text-align:right;">
0.0828025
</td>
<td style="text-align:right;">
0.1592357
</td>
<td style="text-align:right;">
0.0828025
</td>
<td style="text-align:right;">
0.6369427
</td>
<td style="text-align:right;">
0.0382166
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570049
</td>
<td style="text-align:right;">
0.0342857
</td>
<td style="text-align:right;">
0.0742857
</td>
<td style="text-align:right;">
0.0342857
</td>
<td style="text-align:right;">
0.2857143
</td>
<td style="text-align:right;">
0.5714286
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570050
</td>
<td style="text-align:right;">
0.5714286
</td>
<td style="text-align:right;">
0.2857143
</td>
<td style="text-align:right;">
0.0342857
</td>
<td style="text-align:right;">
0.0742857
</td>
<td style="text-align:right;">
0.0342857
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570051
</td>
<td style="text-align:right;">
0.0382166
</td>
<td style="text-align:right;">
0.6369427
</td>
<td style="text-align:right;">
0.0828025
</td>
<td style="text-align:right;">
0.1592357
</td>
<td style="text-align:right;">
0.0828025
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570052
</td>
<td style="text-align:right;">
0.1092437
</td>
<td style="text-align:right;">
0.0504202
</td>
<td style="text-align:right;">
0.2100840
</td>
<td style="text-align:right;">
0.4201681
</td>
<td style="text-align:right;">
0.2100840
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570053
</td>
<td style="text-align:right;">
0.1315789
</td>
<td style="text-align:right;">
0.0684211
</td>
<td style="text-align:right;">
0.0105263
</td>
<td style="text-align:right;">
0.5263158
</td>
<td style="text-align:right;">
0.2631579
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM1570054
</td>
<td style="text-align:right;">
0.2717391
</td>
<td style="text-align:right;">
0.1358696
</td>
<td style="text-align:right;">
0.0163043
</td>
<td style="text-align:right;">
0.0326087
</td>
<td style="text-align:right;">
0.5434783
</td>
</tr>
</tbody>
</table>
<p>Then we performed ICA decomposing into 6 components as we account for the possible junk component.</p>
<pre class="sourceCode r" id="cb28"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">GSE64385_ica &lt;-<span class="st"> </span><span class="kw">run_fastica</span> (</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">  <span class="kw">exprs</span>(GSE64385),</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">  <span class="dt">overdecompose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">  <span class="dt">with.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">  <span class="dt">gene.names =</span> <span class="kw">row.names</span>(<span class="kw">exprs</span>(GSE64385)),</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">  <span class="dt">samples =</span> <span class="kw">colnames</span>(<span class="kw">exprs</span>(GSE64385)),</a>
<a class="sourceLine" id="cb28-7" data-line-number="7">  <span class="dt">n.comp =</span> <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">  <span class="dt">R =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb28-9" data-line-number="9">)</a></code></pre>
<p>The components are oriented according to <em>long tail</em> even without verifying correlations, once we select the top 10 genes of each component we can generate scores.</p>
<pre class="sourceCode r" id="cb29"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">GSE64385_ica_markers_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">generate_markers</span>(GSE64385_ica, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">GSE64385.ica_scores &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">  </span><span class="kw">get_scores</span>(GSE64385_ica<span class="op">$</span>log.counts, GSE64385_ica_markers_<span class="dv">10</span>)</a></code></pre>
<pre class="sourceCode r" id="cb30"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">scores_corr_plot</span>(GSE64385.ica_scores[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],cell_prop.clean.scaled,  <span class="dt">method=</span><span class="st">&quot;number&quot;</span>,  <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-43-1.png" /><!-- --></p>
<p>And even better accuracy can be obtained if we compute scores on <em>un-logged</em> data, actual counts.</p>
<pre class="sourceCode r" id="cb31"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">GSE64385.ica_scores_unlog &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">  </span><span class="kw">get_scores</span>((<span class="dv">2</span><span class="op">^</span>GSE64385_ica<span class="op">$</span>log.counts)<span class="op">-</span><span class="dv">1</span>, GSE64385_ica_markers_<span class="dv">10</span>)</a></code></pre>
<pre class="sourceCode r" id="cb32"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">scores_corr_plot</span>(GSE64385.ica_scores_unlog[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],cell_prop.clean.scaled[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],  <span class="dt">method=</span><span class="st">&quot;number&quot;</span>,  <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-47-1.png" /><!-- --></p>
</div>
<div id="blood-data-paired-with-facs-estimated-proportions" class="section level3">
<h3>Blood data paired with FACS estimated proportions</h3>
<p>Here we will use <code>SDY420</code> dataset from <a href="http://www.immport.org/immport-open/public/home/home">Immport</a> database that <span class="citation">Aran, Hu, and Butte (2017)</span> kindly shared with us. They contain PBMC expression data of 104 healthy patients and paired FACS proportion estimation.</p>
<pre class="sourceCode r" id="cb33"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co">#import expression data</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2">GE_SDY420 &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data-raw/xCell_ImmPort/GE_SDY420.txt&quot;</span>, <span class="dt">row.names=</span><span class="dv">1</span>, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</a></code></pre>
<pre class="sourceCode r" id="cb34"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">dim</span>(GE_SDY420)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="co">#&gt; [1] 12027   104</span></a></code></pre>
<pre class="sourceCode r" id="cb35"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">summary</span>(GE_SDY420)[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="co">#&gt;    SUB137169        SUB137172        SUB137208     </span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="co">#&gt;  Min.   : 5.840   Min.   : 4.099   Min.   : 4.140  </span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">#&gt;  1st Qu.: 6.254   1st Qu.: 6.211   1st Qu.: 6.083  </span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="co">#&gt;  Median : 6.716   Median : 6.742   Median : 7.137  </span></a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="co">#&gt;  Mean   : 7.335   Mean   : 7.335   Mean   : 7.336  </span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="co">#&gt;  3rd Qu.: 7.982   3rd Qu.: 8.041   3rd Qu.: 8.278  </span></a>
<a class="sourceLine" id="cb35-8" data-line-number="8"><span class="co">#&gt;  Max.   :15.059   Max.   :15.664   Max.   :15.216</span></a></code></pre>
<p>In order to define number of components we can perform <code>doICABatch</code> that scans an array of decompositions looking for the most reproducible ones. The methodology was published in <span class="citation">(Kairov et al. 2017)</span>.</p>
<p>The function saves on the disk all the studied decomposition and generates plots of stability.</p>
<pre class="sourceCode r" id="cb36"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">GE_SDY420_batch.res&lt;-<span class="kw">doICABatch</span>(GE_SDY420,</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">           <span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">100</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">           <span class="dt">names =</span> <span class="kw">row.names</span>(GE_SDY420),</a>
<a class="sourceLine" id="cb36-4" data-line-number="4">           <span class="dt">samples =</span> <span class="kw">colnames</span>(GE_SDY420))</a></code></pre>
<p><img src="figures-ext/MSTD_estimate.png" width="433.3px" height="359.3px" style="display: block; margin: auto;" /> <img src="figures-ext/AverageStability.png" width="433.3px" height="359.3px" style="display: block; margin: auto;" /></p>
<p>The MST = 39 indicates most reproducible number of components. Let‚Äôs verify if among 39 components we find components associated with the immune cells.</p>
<p>You can load the file with decomposition from <code>data-vignettes</code>repo.</p>
<pre class="sourceCode r" id="cb37"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">GE_SDY420_ica_<span class="dv">39</span> &lt;-<span class="st"> </span><span class="kw">run_fastica</span> (</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">  GE_SDY420,</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">  <span class="dt">gene.names =</span> <span class="kw">row.names</span>(GE_SDY420),</a>
<a class="sourceLine" id="cb37-4" data-line-number="4">  <span class="dt">samples =</span> <span class="kw">colnames</span>(GE_SDY420),</a>
<a class="sourceLine" id="cb37-5" data-line-number="5">  <span class="dt">overdecompose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb37-6" data-line-number="6">  <span class="dt">with.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">  <span class="dt">n.comp =</span> <span class="dv">39</span>,</a>
<a class="sourceLine" id="cb37-8" data-line-number="8">  <span class="dt">R =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb37-9" data-line-number="9">)</a></code></pre>
<p>Then we perform our pipeline comparing to pure immune profiles from <span class="citation">(Newman et al. 2015)</span>.</p>
<pre class="sourceCode r" id="cb38"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">GE_SDY420_ica_<span class="fl">39.</span>corr.LM22 &lt;-</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="st">  </span><span class="kw">correlate_metagenes</span> (GE_SDY420_ica_<span class="dv">39</span><span class="op">$</span>S, GE_SDY420_ica_<span class="dv">39</span><span class="op">$</span>names, <span class="dt">metagenes =</span> LM22.list)</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"></a>
<a class="sourceLine" id="cb38-4" data-line-number="4">GE_SDY420_ica_<span class="fl">39.</span>corr.LM22.p &lt;-</a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="st">  </span><span class="kw">radar_plot_corr</span>(GE_SDY420_ica_<span class="fl">39.</span>corr.LM22,</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">                  <span class="dt">ax.size =</span> <span class="dv">12</span>,</a>
<a class="sourceLine" id="cb38-7" data-line-number="7">                  <span class="dt">size.el.txt =</span> <span class="dv">22</span>,</a>
<a class="sourceLine" id="cb38-8" data-line-number="8">                  <span class="dt">point.size =</span> <span class="dv">7</span>)</a></code></pre>
<pre class="sourceCode r" id="cb39"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">GE_SDY420_ica_<span class="fl">39.</span>corr.LM22.p<span class="op">$</span>p</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-58-1.png" /><!-- --></p>
<pre class="sourceCode r" id="cb40"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">GE_SDY420_ica_<span class="fl">39.</span>LM22.reciprocal.corr &lt;-</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">  </span><span class="kw">assign_metagenes</span>(GE_SDY420_ica_<span class="fl">39.</span>corr.LM22<span class="op">$</span>r, <span class="dt">exclude_name =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="co">#&gt; no profiles to exlude provided</span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="co">#&gt; DONE</span></a></code></pre>
<pre class="sourceCode r" id="cb41"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">kable</span>(GE_SDY420_ica_<span class="fl">39.</span>LM22.reciprocal.corr, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
profile
</th>
<th style="text-align:left;">
component
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
B.cells.naive
</td>
<td style="text-align:left;">
IC38
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD4.naive
</td>
<td style="text-align:left;">
IC22
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD4.memory.activated
</td>
<td style="text-align:left;">
IC20
</td>
</tr>
<tr>
<td style="text-align:left;">
NK.cells.resting
</td>
<td style="text-align:left;">
IC13
</td>
</tr>
<tr>
<td style="text-align:left;">
Monocytes
</td>
<td style="text-align:left;">
IC21
</td>
</tr>
<tr>
<td style="text-align:left;">
Macrophages.M0
</td>
<td style="text-align:left;">
IC33
</td>
</tr>
<tr>
<td style="text-align:left;">
Macrophages.M1
</td>
<td style="text-align:left;">
IC26
</td>
</tr>
<tr>
<td style="text-align:left;">
Mast.cells.activated
</td>
<td style="text-align:left;">
IC6
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb42"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">GE_SDY420_ica_<span class="fl">39.</span>LM22.max.corr &lt;-<span class="st"> </span><span class="kw">get_max_correlations</span>(GE_SDY420_ica_<span class="fl">39.</span>corr.LM22)</a></code></pre>
<pre class="sourceCode r" id="cb43"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">kable</span>(GE_SDY420_ica_<span class="fl">39.</span>LM22.max.corr, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
TYPE
</th>
<th style="text-align:left;">
IC
</th>
<th style="text-align:right;">
r
</th>
<th style="text-align:right;">
p.val
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
B.cells.naive
</td>
<td style="text-align:left;">
IC38
</td>
<td style="text-align:right;">
0.5965356
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
B.cells.memory
</td>
<td style="text-align:left;">
IC38
</td>
<td style="text-align:right;">
0.5892516
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Plasma.cells
</td>
<td style="text-align:left;">
IC38
</td>
<td style="text-align:right;">
0.3934263
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD8
</td>
<td style="text-align:left;">
IC13
</td>
<td style="text-align:right;">
0.4378895
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD4.naive
</td>
<td style="text-align:left;">
IC22
</td>
<td style="text-align:right;">
0.4459369
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD4.memory.resting
</td>
<td style="text-align:left;">
IC22
</td>
<td style="text-align:right;">
0.4117528
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD4.memory.activated
</td>
<td style="text-align:left;">
IC20
</td>
<td style="text-align:right;">
0.2510106
</td>
<td style="text-align:right;">
0.0000035
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.follicular.helper
</td>
<td style="text-align:left;">
IC22
</td>
<td style="text-align:right;">
0.4280154
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.regulatory..Tregs.
</td>
<td style="text-align:left;">
IC22
</td>
<td style="text-align:right;">
0.4187166
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.gamma.delta
</td>
<td style="text-align:left;">
IC13
</td>
<td style="text-align:right;">
0.5383511
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
NK.cells.resting
</td>
<td style="text-align:left;">
IC13
</td>
<td style="text-align:right;">
0.5429902
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
NK.cells.activated
</td>
<td style="text-align:left;">
IC29
</td>
<td style="text-align:right;">
0.4101813
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Monocytes
</td>
<td style="text-align:left;">
IC21
</td>
<td style="text-align:right;">
0.4123837
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Macrophages.M0
</td>
<td style="text-align:left;">
IC33
</td>
<td style="text-align:right;">
0.4538960
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Macrophages.M1
</td>
<td style="text-align:left;">
IC26
</td>
<td style="text-align:right;">
0.5301073
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Macrophages.M2
</td>
<td style="text-align:left;">
IC35
</td>
<td style="text-align:right;">
0.2675745
</td>
<td style="text-align:right;">
0.0000007
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic.cells.resting
</td>
<td style="text-align:left;">
IC35
</td>
<td style="text-align:right;">
0.2671913
</td>
<td style="text-align:right;">
0.0000008
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic.cells.activated
</td>
<td style="text-align:left;">
IC26
</td>
<td style="text-align:right;">
0.3215513
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Mast.cells.resting
</td>
<td style="text-align:left;">
IC17
</td>
<td style="text-align:right;">
0.0898357
</td>
<td style="text-align:right;">
0.1017364
</td>
</tr>
<tr>
<td style="text-align:left;">
Mast.cells.activated
</td>
<td style="text-align:left;">
IC6
</td>
<td style="text-align:right;">
0.2701451
</td>
<td style="text-align:right;">
0.0000006
</td>
</tr>
<tr>
<td style="text-align:left;">
Eosinophils
</td>
<td style="text-align:left;">
IC17
</td>
<td style="text-align:right;">
0.1723216
</td>
<td style="text-align:right;">
0.0015973
</td>
</tr>
<tr>
<td style="text-align:left;">
Neutrophils
</td>
<td style="text-align:left;">
IC21
</td>
<td style="text-align:right;">
0.3548045
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
<p>Both reciprocal and maximal correlations indicate a set of components that can be labelled as immune cells. Let‚Äôs verify if we can use them to estimate proportions of those cell types.</p>
<pre class="sourceCode r" id="cb44"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">SDY420_markers_<span class="dv">10</span> &lt;-</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="st">  </span><span class="kw">generate_markers</span>(</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">    <span class="dt">df =</span> GE_SDY420_ica_<span class="dv">39</span>,</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">    <span class="dt">n =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb44-5" data-line-number="5">    <span class="dt">sel.comp =</span> <span class="kw">as.character</span>(<span class="kw">unique</span>(GE_SDY420_ica_<span class="fl">39.</span>LM22.max.corr<span class="op">$</span>IC)),</a>
<a class="sourceLine" id="cb44-6" data-line-number="6">    <span class="dt">return =</span> <span class="st">&quot;gene.list&quot;</span></a>
<a class="sourceLine" id="cb44-7" data-line-number="7">  )</a></code></pre>
<pre class="sourceCode r" id="cb45"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">GE_SDY420_ica_<span class="dv">39</span>_scores &lt;-</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="st">  </span><span class="kw">get_scores</span> ((<span class="dv">2</span> <span class="op">^</span><span class="st"> </span>GE_SDY420_ica_<span class="dv">39</span><span class="op">$</span>log.counts) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">  SDY420_markers_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb45-4" data-line-number="4">  <span class="dt">summary =</span> <span class="st">&quot;mean&quot;</span>,</a>
<a class="sourceLine" id="cb45-5" data-line-number="5">  <span class="dt">na.rm =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb45-6" data-line-number="6">  )</a></code></pre>
<pre class="sourceCode r" id="cb46"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">head</span>(GE_SDY420_ica_<span class="dv">39</span>_scores)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="co">#&gt;                IC38     IC13     IC22     IC20      IC29      IC21</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="co">#&gt; SUB137169 1030.7341 1336.840 1832.286 155.9163  899.3425 1074.8662</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="co">#&gt; SUB137172 1818.6165 1123.062 1374.354 157.4036  960.5435 2927.9662</span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5"><span class="co">#&gt; SUB137208 1118.0113 1350.213 1465.132 150.7131  906.9577 1234.6859</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6"><span class="co">#&gt; SUB137209  981.7916 1427.991 1705.373 158.0823  926.9521  969.4372</span></a>
<a class="sourceLine" id="cb46-7" data-line-number="7"><span class="co">#&gt; SUB137220 1010.8262 2430.426 1655.813 179.0462 1037.9035  950.5174</span></a>
<a class="sourceLine" id="cb46-8" data-line-number="8"><span class="co">#&gt; SUB137224  794.8479 1296.308 1484.678 160.0176 1016.9566  701.2229</span></a>
<a class="sourceLine" id="cb46-9" data-line-number="9"><span class="co">#&gt;               IC33      IC26      IC35      IC17       IC6</span></a>
<a class="sourceLine" id="cb46-10" data-line-number="10"><span class="co">#&gt; SUB137169 1261.044  393.0449  604.0954 123.63160 1232.1581</span></a>
<a class="sourceLine" id="cb46-11" data-line-number="11"><span class="co">#&gt; SUB137172 1011.749  710.6023 1531.9271  69.45387 3012.6474</span></a>
<a class="sourceLine" id="cb46-12" data-line-number="12"><span class="co">#&gt; SUB137208 1687.398  523.3801  594.8693 843.23650  619.2452</span></a>
<a class="sourceLine" id="cb46-13" data-line-number="13"><span class="co">#&gt; SUB137209 1032.434 1021.3100  454.9859 183.05840 4064.6511</span></a>
<a class="sourceLine" id="cb46-14" data-line-number="14"><span class="co">#&gt; SUB137220 1351.556  436.3534  594.5121  70.55523 1287.1568</span></a>
<a class="sourceLine" id="cb46-15" data-line-number="15"><span class="co">#&gt; SUB137224 1490.662  415.4843  438.7275 116.07239  732.3497</span></a></code></pre>
<p>As we have FACS measured proportions we can import them.</p>
<pre class="sourceCode r" id="cb47"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="co">#import facs estimated proportions</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2">FACS_SDY420 &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;../data-raw/xCell_ImmPort/FCS_SDY420.txt&quot;</span>, <span class="dt">row.names=</span><span class="dv">1</span>, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</a></code></pre>
<pre class="sourceCode r" id="cb48"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">dim</span>(FACS_SDY420)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="co">#&gt; [1]  24 104</span></a></code></pre>
<pre class="sourceCode r" id="cb49"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">common.samples &lt;-<span class="st"> </span><span class="kw">intersect</span>(<span class="kw">colnames</span>(FACS_SDY420), <span class="kw">colnames</span>(GE_SDY420))</a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="kw">length</span>(common.samples)</a>
<a class="sourceLine" id="cb49-3" data-line-number="3"><span class="co">#&gt; [1] 104</span></a></code></pre>
<pre class="sourceCode r" id="cb50"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">FACS_SDY420.fil &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(FACS_SDY420[, common.samples]))</a></code></pre>
<pre class="sourceCode r" id="cb51"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">head</span>(FACS_SDY420.fil)[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="co">#&gt;           B.cells CD16..monocytes CD16..monocytes.1 CD4..T.cells</span></a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="co">#&gt; SUB137169  0.0710          0.1430            0.0080       0.4138</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="co">#&gt; SUB137172  0.1342          0.1695            0.0155       0.2014</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="co">#&gt; SUB137208  0.1344          0.2324            0.0101       0.2301</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"><span class="co">#&gt; SUB137209  0.0858          0.2006            0.0114       0.2718</span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7"><span class="co">#&gt; SUB137220  0.0493          0.1600            0.0089       0.2618</span></a>
<a class="sourceLine" id="cb51-8" data-line-number="8"><span class="co">#&gt; SUB137224  0.0626          0.1663            0.0136       0.3320</span></a></code></pre>
<p>And we can confront the abundance scores.</p>
<pre class="sourceCode r" id="cb52"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">scores_corr_plot</span>(GE_SDY420_ica_<span class="dv">39</span>_scores,FACS_SDY420.fil,  <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre>
<pre class="sourceCode r" id="cb53"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;./figures-ext/CorrBlood.jpeg&quot;</span>)</a></code></pre>
<p><img src="figures-ext/CorrBlood.jpeg" /><!-- --></p>
<p>The estimation of abundance gives remarkable accuracy (Pearson correlation coefficient):</p>
<ul>
<li>IC38: B-cells: 0.76</li>
<li>CD4 T-cells: 0.629</li>
<li>CD8 T-cells: 0.63</li>
<li>NK: 0.43</li>
<li>Monocytes: 0.42</li>
</ul>
<p>This results is also highly comparable with (or even better than) results obtained with other tools, published in <em>xCell</em> publication by <span class="citation">Aran, Hu, and Butte (2017)</span>.</p>
<p><img src="figures-ext/SDY420.comp.png" width="1137" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="overview-of-functions" class="section level2">
<h2>Overview of functions</h2>
<p>In this section we will discuss main functions of the package and their different options on computationally light toy examples. If you are interested in demo application of <code>deconICA</code> with biological arguments go straight to section <a href="#cases">Demonstration of DeconICA package</a></p>
<p>You can use <code>run_fastica()</code> function to decompose a matrix into independent components</p>
<pre class="sourceCode r" id="cb54"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">S &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">10000</span>), <span class="dv">5000</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">3</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(S <span class="op">%*%</span><span class="st"> </span>A)</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">res &lt;-<span class="st"> </span><span class="kw">run_fastica</span>(<span class="dt">X =</span> X, <span class="dt">row.center =</span> <span class="ot">TRUE</span>, <span class="dt">n.comp =</span> <span class="dv">2</span>, <span class="dt">overdecompose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb54-5" data-line-number="5"><span class="co">#&gt; running PCA</span></a>
<a class="sourceLine" id="cb54-6" data-line-number="6"><span class="co">#&gt; running ICA for 2 components</span></a>
<a class="sourceLine" id="cb54-7" data-line-number="7"><span class="co">#&gt; adding names to the object</span></a>
<a class="sourceLine" id="cb54-8" data-line-number="8"><span class="co">#&gt; adding sample names to the object</span></a>
<a class="sourceLine" id="cb54-9" data-line-number="9"><span class="co">#&gt; adding counts in log to the object</span></a>
<a class="sourceLine" id="cb54-10" data-line-number="10"><span class="kw">str</span>(res)</a>
<a class="sourceLine" id="cb54-11" data-line-number="11"><span class="co">#&gt; List of 8</span></a>
<a class="sourceLine" id="cb54-12" data-line-number="12"><span class="co">#&gt;  $ X         : num [1:5000, 1:2] 0.989 1.337 1.133 -1.105 -1.281 ...</span></a>
<a class="sourceLine" id="cb54-13" data-line-number="13"><span class="co">#&gt;  $ K         : num [1:2, 1:2] -1.22 -6.69e-16 -9.93 1.81e+16</span></a>
<a class="sourceLine" id="cb54-14" data-line-number="14"><span class="co">#&gt;  $ W         : num [1:2, 1:2] 0.0137 0.9999 -0.9999 0.0137</span></a>
<a class="sourceLine" id="cb54-15" data-line-number="15"><span class="co">#&gt;  $ A         : num [1:2, 1:2] -Inf Inf NaN NaN</span></a>
<a class="sourceLine" id="cb54-16" data-line-number="16"><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></a>
<a class="sourceLine" id="cb54-17" data-line-number="17"><span class="co">#&gt;   .. ..$ : chr [1:2] &quot;IC1&quot; &quot;IC2&quot;</span></a>
<a class="sourceLine" id="cb54-18" data-line-number="18"><span class="co">#&gt;   .. ..$ : chr [1:2] &quot;X1&quot; &quot;X2&quot;</span></a>
<a class="sourceLine" id="cb54-19" data-line-number="19"><span class="co">#&gt;  $ S         : num [1:5000, 1:2] 0.105 -0.103 0.178 0.885 2.639 ...</span></a>
<a class="sourceLine" id="cb54-20" data-line-number="20"><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></a>
<a class="sourceLine" id="cb54-21" data-line-number="21"><span class="co">#&gt;   .. ..$ : chr [1:5000] &quot;X1&quot; &quot;X2&quot; &quot;X3&quot; &quot;X4&quot; ...</span></a>
<a class="sourceLine" id="cb54-22" data-line-number="22"><span class="co">#&gt;   .. ..$ : chr [1:2] &quot;IC1&quot; &quot;IC2&quot;</span></a>
<a class="sourceLine" id="cb54-23" data-line-number="23"><span class="co">#&gt;  $ names     : chr [1:5000] &quot;X1&quot; &quot;X2&quot; &quot;X3&quot; &quot;X4&quot; ...</span></a>
<a class="sourceLine" id="cb54-24" data-line-number="24"><span class="co">#&gt;  $ samples   : chr [1:2] &quot;X1&quot; &quot;X2&quot;</span></a>
<a class="sourceLine" id="cb54-25" data-line-number="25"><span class="co">#&gt;  $ log.counts:&#39;data.frame&#39;:  5000 obs. of  2 variables:</span></a>
<a class="sourceLine" id="cb54-26" data-line-number="26"><span class="co">#&gt;   ..$ X1: num [1:5000] 0.8349 0.1645 0.885 -0.0892 -0.8865 ...</span></a>
<a class="sourceLine" id="cb54-27" data-line-number="27"><span class="co">#&gt;   ..$ X2: num [1:5000] 1.425 0.262 1.272 3.462 2.914 ...</span></a></code></pre>
<p><code>run_fastica</code> runs <code>fastica</code> from <code>fastica</code> package. In this trivial example we create sources matrix <code>S</code>and mixing matrix <code>A</code> that we multiply to obtain <code>X</code>. Then we decompose <code>X</code> into <code>n.comp = 2</code>, with row centering (substracting mean from each row) <code>row.center = TRUE</code>. We also checked <code>overdecompose = FALSE</code>, <code>overdecompose = TRUE</code> would ignore number of components we defined with <code>ncomp</code>. It finds its use for more advanced analysis applied to transcriptome [see section <a href="#cases">Demonstration of DeconICA package</a>]. Other parameters were selected as default.</p>
<p>Full description of the <code>run_fastica</code> parameters can be found in help <code>?run_fastica</code>.</p>
<p>The main differences between <code>run_fastica</code> and <code>fastica</code> are:</p>
<ul>
<li>if column names are provided with the matrix, duplicated names are removed and entries with higher variance are kept</li>
<li>it transforms data into log2 if data are in row counts</li>
<li>it runs a PCA before ICA to denoise the matrix</li>
<li>it allows running matlab version fastica with <em>icasso</em> stabilisation if matlab software is installed on your machine (more about this point in <a href="Icasso.html">vignette: Running fastICA with icasso stabilisation</a>)</li>
<li>it returns in a <code>list</code>
<ul>
<li>input <code>data.frame</code> without duplicated entries and before log transformation: <code>log.counts</code></li>
<li><code>names</code> row names vector</li>
<li><code>samples</code>sample names vector</li>
<li><code>A</code>, <code>S</code>, <code>K</code> and <code>W</code> matrices (see <code>?run_fastica</code> for details) if run in <code>R=TRUE</code></li>
<li><code>A</code> and <code>S</code> matrices if run with <code>R=FALSE</code></li>
</ul></li>
<li><code>overdecompose</code> parameter that selects number of composed needed to perform overdecomposition of the input matrix</li>
</ul>
<p>Therefore, <code>run_fastica()</code> performs ICA decomposition of the matrix and provides additional features useful for the downstream analysis. The use of more advanced options will be demonstrated later on in this tutorial. It generates <em>components</em> or <em>sources</em> to which we will refer later on in the tutorial.</p>
<p>The step naturally following <code>run_fastica()</code> is <code>correlate_metagenes()</code>.</p>
<p>It is common that after an unsupervised decomposition, components should have attributed an interpretation or a meaning or a label. We call this process <em>interpret</em> components or <em>identify</em> sources. A domain knowledge is necessary to interpret components. In the case of transcriptomic data, components can be seen as weighted gene list.</p>
<p>An efficient way to in interpret a component is to use correlation with some known profile or as we call it a <em>metagene</em>. If we dispose of a known weighted list of genes that characterize a biological phenomena or a cell type (a metagene), we can then correlate them with obtained components and verify is some of decomposed sources are close to the known cells/functions.</p>
<p>In our <code>deconICA</code> pipeline <code>correlate_metagenes()</code> can be used in order to correlate metagenes (gene lists: knowlege-based or data-driven) with the data-driven components.</p>
<pre class="sourceCode r" id="cb55"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">library</span>(deconica)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">data</span>(Example_ds)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="co">#decompose the matrix</span></a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb55-5" data-line-number="5">res_run_ica &lt;-<span class="st"> </span><span class="kw">run_fastica</span> (</a>
<a class="sourceLine" id="cb55-6" data-line-number="6">  Example_ds,</a>
<a class="sourceLine" id="cb55-7" data-line-number="7">  <span class="dt">overdecompose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb55-8" data-line-number="8">  <span class="dt">with.names =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb55-9" data-line-number="9">  <span class="dt">n.comp =</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb55-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb55-11" data-line-number="11"><span class="co">#&gt; running PCA</span></a>
<a class="sourceLine" id="cb55-12" data-line-number="12"><span class="co">#&gt; running ICA for 10 components</span></a>
<a class="sourceLine" id="cb55-13" data-line-number="13"><span class="co">#&gt; adding names to the object</span></a>
<a class="sourceLine" id="cb55-14" data-line-number="14"><span class="co">#&gt; adding sample names to the object</span></a>
<a class="sourceLine" id="cb55-15" data-line-number="15"><span class="co">#&gt; adding counts in log to the object</span></a>
<a class="sourceLine" id="cb55-16" data-line-number="16"></a>
<a class="sourceLine" id="cb55-17" data-line-number="17"><span class="co">#correlate with Biton et al. metagenes</span></a>
<a class="sourceLine" id="cb55-18" data-line-number="18">corr &lt;-<span class="st"> </span><span class="kw">correlate_metagenes</span>(<span class="dt">S =</span> res_run_ica<span class="op">$</span>S,</a>
<a class="sourceLine" id="cb55-19" data-line-number="19">                          <span class="dt">gene.names =</span> res_run_ica<span class="op">$</span>names, </a>
<a class="sourceLine" id="cb55-20" data-line-number="20">                          <span class="dt">metagenes =</span> Biton.list</a>
<a class="sourceLine" id="cb55-21" data-line-number="21">                           )</a></code></pre>
<p>In this case we use an example of an extract, of 60 samples, from transcriptomic data from breast cancer <span class="citation">(Bekhouche et al. 2011)</span>. At first, dataset is decomposed into an arbitrary number of 10 components. The <code>correlate_metagenes()</code> correlates the obtained <code>S</code> matrix with <em>Biton et al.</em> metagenes <span class="citation">(Biton et al. 2014)</span>. This set of 11 metagenes is data-driven and was derived in the article <span class="citation">Biton et al. (2014)</span> from pan-cancer transcriptome as the reproducible signals, common to many cancer types. Some of the signatures as BCLAPATHWAYS or UROTHELIALDIF (urothelialdifferentiation) were shared among many datasets, but within bladder cancer. They can bees as a sort of negative control.</p>
<p>However, any set weighted signatures with reasonable size can be used as metagenes. Later in this tutorial we use immune cell profiles optimized for cell type deconvolution from <span class="citation">(Newman et al. 2015)</span> <code>LM22.list</code>.</p>
<p>One can controle a minimal number of genes used for correlation with <code>n.genes.intersect</code> it is set to a magic number in statistics (30) by default.</p>
<pre class="sourceCode r" id="cb56"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">names</span>(corr)</a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="co">#&gt; [1] &quot;S.or&quot; &quot;n&quot;    &quot;r&quot;    &quot;P&quot;</span></a></code></pre>
<p>The <code>correlate_metagenes()</code> returns <code>n</code>, <code>r</code>, <code>P</code> matrices which correspond to <a href="https://www.rdocumentation.org/packages/Hmisc/versions/4.1-0/topics/rcorr"><code>Hmisc::rcorr</code></a> function output, number of genes on which correlation is based, correlation coefficient and p-value.</p>
<p>The <code>S.or</code> stands for <code>S</code> matrix that is <em>oriented</em>. Why the matrix should be oriented? If you used ICA to decompose gene expression then the positive and negative projections do not have meaning by itself. We developed a methodology orienting data in the direction of the <em>long tail</em> of the distribution. Which means highest absolute values of a component weight should be positive. However, if the distribution doesn‚Äôt have <em>tails</em> and is close to gaussian, an alternative, can be orienting components through maximal correlation. If we are confident with our metagenes, we can orient the <code>S</code> matrix so that the maximal correlation is always positive. We demonstrate the use of <code>orient.max = FALSE</code> and obtained <code>S.or</code>in <a href="#cases">use cases section</a>. One can decide not to orient the <code>S</code> matrix through selecting <code>orient.long = FALSE</code> and <code>orient.max = FALSE</code>.</p>
<p>If we have a look at <code>r</code> matrix, we see, indeed, it contains correlations between components and provided metagenes.</p>
<pre class="sourceCode r" id="cb57"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">head</span>(corr<span class="op">$</span>r)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="co">#&gt;     M12_MYOFIBROBLASTS M13_BLCAPATHWAYS  M14_STRESS M2_GC_CONTENT</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="co">#&gt; IC1       5.241598e-03       0.11551181 -0.05863261   0.001829696</span></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="co">#&gt; IC2       3.872262e-02       0.05786138  0.11436405   0.006144067</span></a>
<a class="sourceLine" id="cb57-5" data-line-number="5"><span class="co">#&gt; IC3       8.789440e-02       0.02586692 -0.01506925  -0.027817853</span></a>
<a class="sourceLine" id="cb57-6" data-line-number="6"><span class="co">#&gt; IC4       7.534325e-01      -0.02125887  0.22186764   0.062138866</span></a>
<a class="sourceLine" id="cb57-7" data-line-number="7"><span class="co">#&gt; IC5      -1.393165e-05      -0.13490904 -0.02972322  -0.001664296</span></a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="co">#&gt; IC6       1.442049e-02       0.04582809  0.01508958  -0.189164862</span></a>
<a class="sourceLine" id="cb57-9" data-line-number="9"><span class="co">#&gt;     M3_SMOOTH_MUSCLE M4_MITOCHONRIA_TRANSLATION M5_INTERFERON M6_BASALLIKE</span></a>
<a class="sourceLine" id="cb57-10" data-line-number="10"><span class="co">#&gt; IC1       0.28082149                -0.20320196  -0.138082269  -0.02895456</span></a>
<a class="sourceLine" id="cb57-11" data-line-number="11"><span class="co">#&gt; IC2       0.04300946                -0.05986897  -0.103115638   0.07220367</span></a>
<a class="sourceLine" id="cb57-12" data-line-number="12"><span class="co">#&gt; IC3      -0.01987917                -0.16167704  -0.061727219   0.10881091</span></a>
<a class="sourceLine" id="cb57-13" data-line-number="13"><span class="co">#&gt; IC4       0.44002012                -0.14025239   0.003064779  -0.04316638</span></a>
<a class="sourceLine" id="cb57-14" data-line-number="14"><span class="co">#&gt; IC5      -0.16530245                 0.02677519   0.156166568   0.07481530</span></a>
<a class="sourceLine" id="cb57-15" data-line-number="15"><span class="co">#&gt; IC6      -0.04016218                 0.34503586   0.023152228   0.04141703</span></a>
<a class="sourceLine" id="cb57-16" data-line-number="16"><span class="co">#&gt;     M7_CELLCYCLE    M8_IMMUNE M9_UROTHELIALDIFF</span></a>
<a class="sourceLine" id="cb57-17" data-line-number="17"><span class="co">#&gt; IC1 -0.275278283  0.042007208      -0.007860347</span></a>
<a class="sourceLine" id="cb57-18" data-line-number="18"><span class="co">#&gt; IC2 -0.173358489 -0.004013247      -0.026667308</span></a>
<a class="sourceLine" id="cb57-19" data-line-number="19"><span class="co">#&gt; IC3  0.123241033  0.093491330       0.037031845</span></a>
<a class="sourceLine" id="cb57-20" data-line-number="20"><span class="co">#&gt; IC4 -0.149189096 -0.044283111      -0.084404694</span></a>
<a class="sourceLine" id="cb57-21" data-line-number="21"><span class="co">#&gt; IC5  0.603076352 -0.030319023      -0.001772235</span></a>
<a class="sourceLine" id="cb57-22" data-line-number="22"><span class="co">#&gt; IC6  0.005530295  0.101156377      -0.017695373</span></a></code></pre>
<p>These correlation matrix can be visualized in many ways. We propose a <em>radar plot</em> to evaluate quickly if there is a good match between metagenes and components. In this representation, we focus on positive correlations that have red color and placed away from the center of the circle (radar). We can see which component is attributed to the highest correlation for each metagene.</p>
<pre class="sourceCode r" id="cb58"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">p &lt;-<span class="st"> </span><span class="kw">radar_plot_corr</span>(corr, <span class="dt">size.el.txt =</span> <span class="dv">10</span>, <span class="dt">point.size =</span> <span class="dv">2</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-80-1.png" /><!-- --></p>
<p>The function <code>radar_plot_corr()</code> returns as well the matrix in long format suitable for <code>ggplot2</code> plots in case you want to use a different type of visualization.</p>
<pre class="sourceCode r" id="cb59"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">head</span>(p<span class="op">$</span>df)</a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="co">#&gt;   component   correlation           metagene</span></a>
<a class="sourceLine" id="cb59-3" data-line-number="3"><span class="co">#&gt; 1       IC1  5.241598e-03 M12_MYOFIBROBLASTS</span></a>
<a class="sourceLine" id="cb59-4" data-line-number="4"><span class="co">#&gt; 2       IC2  3.872262e-02 M12_MYOFIBROBLASTS</span></a>
<a class="sourceLine" id="cb59-5" data-line-number="5"><span class="co">#&gt; 3       IC3  8.789440e-02 M12_MYOFIBROBLASTS</span></a>
<a class="sourceLine" id="cb59-6" data-line-number="6"><span class="co">#&gt; 4       IC4  7.534325e-01 M12_MYOFIBROBLASTS</span></a>
<a class="sourceLine" id="cb59-7" data-line-number="7"><span class="co">#&gt; 5       IC5 -1.393165e-05 M12_MYOFIBROBLASTS</span></a>
<a class="sourceLine" id="cb59-8" data-line-number="8"><span class="co">#&gt; 6       IC6  1.442049e-02 M12_MYOFIBROBLASTS</span></a></code></pre>
<p>In order to <em>zoom in</em> into a correlation with a specific metagene, one can use a function <code>lolypop_plot_corr()</code></p>
<p>Here we can visualize for example SMOOTH_MUSCLE metagene that seems a bit ambigous.</p>
<pre class="sourceCode r" id="cb60"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">lolypop_plot_corr</span>(corr<span class="op">$</span>r,<span class="st">&quot;M3_SMOOTH_MUSCLE&quot;</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-84-1.png" /><!-- --></p>
<p>We can observe that the highest correlation is with IC4 0.44 but IC1: 0.28 is close as well. These two components may represent two different types of functions or cells reated to muscles.</p>
<p>However, if we look at IMMUNE metagene, we can select one strongly correlated component: IC9, Pearson correlation coefficient equal to 0.73.</p>
<pre class="sourceCode r" id="cb61"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">lolypop_plot_corr</span>(corr<span class="op">$</span>r,<span class="st">&quot;M8_IMMUNE&quot;</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-87-1.png" /><!-- --></p>
<p>In case we have many profiles, an automatic extraction of corresponding pairs metagene - component is handy.</p>
<p>A natural way is consider the component which Pearson correlation coefficient is highest as the one <em>corresponding</em> to a metagene. You can use <code>get_max_correlations()</code> to retrieve this information from the correlation matrix.</p>
<pre class="sourceCode r" id="cb62"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="co"># retrieve max correlations</span></a>
<a class="sourceLine" id="cb62-2" data-line-number="2"> max.corr &lt;-<span class="st"> </span><span class="kw">get_max_correlations</span>(corr)</a>
<a class="sourceLine" id="cb62-3" data-line-number="3"><span class="co"># order</span></a>
<a class="sourceLine" id="cb62-4" data-line-number="4"> max.corr.ordered &lt;-<span class="st"> </span>max.corr[<span class="kw">order</span>(<span class="op">-</span>max.corr<span class="op">$</span>r),]</a>
<a class="sourceLine" id="cb62-5" data-line-number="5"><span class="co"># show table</span></a>
<a class="sourceLine" id="cb62-6" data-line-number="6"><span class="kw">kable</span>(max.corr.ordered,<span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
TYPE
</th>
<th style="text-align:left;">
IC
</th>
<th style="text-align:right;">
r
</th>
<th style="text-align:right;">
p.val
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
M2_GC_CONTENT
</td>
<td style="text-align:left;">
IC10
</td>
<td style="text-align:right;">
0.7812173
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M12_MYOFIBROBLASTS
</td>
<td style="text-align:left;">
IC4
</td>
<td style="text-align:right;">
0.7534325
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M8_IMMUNE
</td>
<td style="text-align:left;">
IC9
</td>
<td style="text-align:right;">
0.7266403
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M7_CELLCYCLE
</td>
<td style="text-align:left;">
IC5
</td>
<td style="text-align:right;">
0.6030764
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M3_SMOOTH_MUSCLE
</td>
<td style="text-align:left;">
IC4
</td>
<td style="text-align:right;">
0.4400201
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M5_INTERFERON
</td>
<td style="text-align:left;">
IC9
</td>
<td style="text-align:right;">
0.4092376
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M4_MITOCHONRIA_TRANSLATION
</td>
<td style="text-align:left;">
IC6
</td>
<td style="text-align:right;">
0.3450359
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M6_BASALLIKE
</td>
<td style="text-align:left;">
IC8
</td>
<td style="text-align:right;">
0.2297117
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M14_STRESS
</td>
<td style="text-align:left;">
IC4
</td>
<td style="text-align:right;">
0.2218676
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M13_BLCAPATHWAYS
</td>
<td style="text-align:left;">
IC1
</td>
<td style="text-align:right;">
0.1155118
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
M9_UROTHELIALDIFF
</td>
<td style="text-align:left;">
IC3
</td>
<td style="text-align:right;">
0.0370318
</td>
<td style="text-align:right;">
0.0002561
</td>
</tr>
</tbody>
</table>
<p><code>get_max_correlations()</code> provides pearson correlation <code>r</code> column and the p-value <code>p.val</code> to help decide if the maximal correlation can be used as labelling. One can decide on minimal threshold, or p-value to take a decision.</p>
<p>Another way to assign metagene to a component can be trough reciprocal correlations. This method was used in our research articles [<span class="citation">Becht et al. (2016)</span>; RBH_paper]. In brief, given correlations between the set of metagenes <span class="math inline">\(M=\{M_{1},...,M_{m}\}\)</span> and <span class="math inline">\(S\)</span> matrix <span class="math inline">\(S=\{IC_{1},...,IC_{N}\}\)</span>, if <span class="math inline">\(S_{i}=argmax_k(corr(M_{j},S_{k}))\)</span> and <span class="math inline">\(A_{j}=argmax_k (corr(S_{i},M_{k}))\)</span>, then <span class="math inline">\(S_{i}\)</span> and <span class="math inline">\(M_{j}\)</span> are reciprocal. This approach is useful with assumption that there should be one component corresponding to a metagene and one metagene corresponding to a component.</p>
<pre class="sourceCode r" id="cb63"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="co"># retrieve reciprocal correlations</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2">reciprocal.corr &lt;-<span class="st"> </span><span class="kw">assign_metagenes</span>(corr<span class="op">$</span>r, <span class="dt">exclude_name =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="co">#&gt; no profiles to exlude provided</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="co">#&gt; DONE</span></a>
<a class="sourceLine" id="cb63-5" data-line-number="5"><span class="co"># show table</span></a>
<a class="sourceLine" id="cb63-6" data-line-number="6"><span class="kw">kable</span>(reciprocal.corr, <span class="st">&quot;html&quot;</span>,<span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
profile
</th>
<th style="text-align:left;">
component
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
M12_MYOFIBROBLASTS
</td>
<td style="text-align:left;">
IC4
</td>
</tr>
<tr>
<td style="text-align:left;">
M2_GC_CONTENT
</td>
<td style="text-align:left;">
IC10
</td>
</tr>
<tr>
<td style="text-align:left;">
M4_MITOCHONRIA_TRANSLATION
</td>
<td style="text-align:left;">
IC6
</td>
</tr>
<tr>
<td style="text-align:left;">
M6_BASALLIKE
</td>
<td style="text-align:left;">
IC8
</td>
</tr>
<tr>
<td style="text-align:left;">
M7_CELLCYCLE
</td>
<td style="text-align:left;">
IC5
</td>
</tr>
<tr>
<td style="text-align:left;">
M8_IMMUNE
</td>
<td style="text-align:left;">
IC9
</td>
</tr>
</tbody>
</table>
<p>Here the corresponding pairs do not follow a specific order. The six of components find a reciprocal match.</p>
<div id="full-pipeline-example" class="section level3">
<h3>Full pipeline example</h3>
<div id="decompose-data" class="section level4">
<h4>Decompose data</h4>
<p>In order to fully explore a dataset with identification and quantification of immune-related signals we suggest to over decompose the data matrix.</p>
<p>We recommend to use for this purpose MATLAB implementation of the algorithm (see <a href="Icasso.html">vignette: Running fastICA with icasso stabilisation</a>)</p>
<p>One can run it like this on BEK complete data (WARNING: requires MATLAB and take a few minutes):</p>
<pre class="sourceCode r" id="cb64"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">library</span>(deconica)</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">BEK_ica_overdecompose &lt;-<span class="st"> </span><span class="kw">run_fastica</span> (</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">  BEK,</a>
<a class="sourceLine" id="cb64-4" data-line-number="4">  <span class="dt">isLog =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb64-5" data-line-number="5">  <span class="dt">overdecompose =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb64-6" data-line-number="6">  <span class="dt">with.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb64-7" data-line-number="7">  <span class="dt">gene.names =</span> <span class="kw">row.names</span>(BEK),</a>
<a class="sourceLine" id="cb64-8" data-line-number="8">  <span class="dt">R =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb64-9" data-line-number="9">)</a></code></pre>
<p>In order to follow this tutorial simply load precomputed ICA decomposition.</p>
<pre class="sourceCode r" id="cb65"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw">data</span>(BEK_ica_overdecompose)</a></code></pre>
</div>
<div id="interpret-components" class="section level4">
<h4>Interpret components</h4>
<pre class="sourceCode r" id="cb66"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="co"># correlate with Biton et al. metagenes</span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2">corr_Biton &lt;-<span class="st"> </span><span class="kw">correlate_metagenes</span>(<span class="dt">S =</span> BEK_ica_overdecompose<span class="op">$</span>S,</a>
<a class="sourceLine" id="cb66-3" data-line-number="3">                            <span class="dt">gene.names =</span> BEK_ica_overdecompose<span class="op">$</span>names,</a>
<a class="sourceLine" id="cb66-4" data-line-number="4">                            <span class="dt">metagenes =</span> Biton.list</a>
<a class="sourceLine" id="cb66-5" data-line-number="5">                            )</a>
<a class="sourceLine" id="cb66-6" data-line-number="6"><span class="co"># correlate with LM22 cell profiles</span></a>
<a class="sourceLine" id="cb66-7" data-line-number="7">corr_LM22 &lt;-<span class="st"> </span><span class="kw">correlate_metagenes</span>(<span class="dt">S =</span> BEK_ica_overdecompose<span class="op">$</span>S,</a>
<a class="sourceLine" id="cb66-8" data-line-number="8">                            <span class="dt">gene.names =</span> BEK_ica_overdecompose<span class="op">$</span>names,</a>
<a class="sourceLine" id="cb66-9" data-line-number="9">                            <span class="dt">metagenes =</span> LM22.list</a>
<a class="sourceLine" id="cb66-10" data-line-number="10">                            )</a></code></pre>
<p>We can illustrate correlations with reference metagenes‚Ä¶</p>
<pre class="sourceCode r" id="cb67"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">radar_plot_corr</span>(corr_Biton, <span class="dt">size.el.txt =</span> <span class="dv">10</span>, <span class="dt">point.size =</span> <span class="dv">2</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-95-1.png" /><!-- --></p>
<p>‚Ä¶ and with LM22 immune cell type profiles.</p>
<pre class="sourceCode r" id="cb68"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">radar_plot_corr</span>(corr_LM22, <span class="dt">size.el.txt =</span> <span class="dv">10</span>, <span class="dt">point.size =</span> <span class="dv">2</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-98-1.png" width="130%" /></p>
<p>And zoom in the <em>M8_IMMUNE</em> metagene.</p>
<pre class="sourceCode r" id="cb69"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">lolypop_plot_corr</span>(corr_Biton<span class="op">$</span>r,<span class="st">&quot;M8_IMMUNE&quot;</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-101-1.png" /><!-- --></p>
<p>As we have several components corresponding to the M8_IMMUNE and a few matches with immune profiles. One can use enrichment test to confirm this results.</p>
<p>First we run reciprocal assignment so that we can exclude from immune signals the confounders as, for example, cell cycle.</p>
<pre class="sourceCode r" id="cb70"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"> reciprocal.corr.Biton &lt;-</a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="st">   </span><span class="kw">assign_metagenes</span>(corr_Biton<span class="op">$</span>r, <span class="dt">exclude_name =</span> <span class="kw">c</span>(<span class="st">&quot;M8_IMMUNE&quot;</span>, <span class="st">&quot;M2_GC_CONTENT&quot;</span>))</a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="co">#&gt; profiles excluded</span></a>
<a class="sourceLine" id="cb70-4" data-line-number="4"><span class="co">#&gt; DONE</span></a>
<a class="sourceLine" id="cb70-5" data-line-number="5"> immune.components &lt;-</a>
<a class="sourceLine" id="cb70-6" data-line-number="6"><span class="st">   </span><span class="kw">identify_immune_comp</span>(corr_Biton<span class="op">$</span>r[, <span class="st">&quot;M8_IMMUNE&quot;</span>], reciprocal.corr.Biton<span class="op">$</span>component)</a></code></pre>
<p>Five components pass the threshold of &gt;0.1 pearson correlation with the IMMUNE component.</p>
<pre class="sourceCode r" id="cb71"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"> immune.components</a>
<a class="sourceLine" id="cb71-2" data-line-number="2"><span class="co">#&gt;       IC4      IC28      IC39      IC49      IC68 </span></a>
<a class="sourceLine" id="cb71-3" data-line-number="3"><span class="co">#&gt; 0.2763554 0.1023885 0.4624926 0.4070063 0.1100752</span></a></code></pre>
<p>We can verify to which cells they may correspond through enrichment test (based on Fisher exact test).</p>
<pre class="sourceCode r" id="cb72"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">enrichment.immune &lt;-<span class="st"> </span><span class="kw">gene_enrichment_test</span>(</a>
<a class="sourceLine" id="cb72-2" data-line-number="2">  BEK_ica_overdecompose<span class="op">$</span>S,</a>
<a class="sourceLine" id="cb72-3" data-line-number="3">  BEK_ica_overdecompose<span class="op">$</span>names,</a>
<a class="sourceLine" id="cb72-4" data-line-number="4">  <span class="dt">immune.ics =</span> <span class="kw">names</span>(immune.components),</a>
<a class="sourceLine" id="cb72-5" data-line-number="5">  <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,</a>
<a class="sourceLine" id="cb72-6" data-line-number="6">  <span class="dt">p.adjust.method =</span> <span class="st">&quot;BH&quot;</span>,</a>
<a class="sourceLine" id="cb72-7" data-line-number="7">  <span class="dt">p.value.threshold =</span> <span class="fl">0.05</span></a>
<a class="sourceLine" id="cb72-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb72-9" data-line-number="9"><span class="co">#&gt; 58 modules higher than threshold: 500</span></a>
<a class="sourceLine" id="cb72-10" data-line-number="10"><span class="co">#&gt; Warning in gene_enrichment_test(BEK_ica_overdecompose$S,</span></a>
<a class="sourceLine" id="cb72-11" data-line-number="11"><span class="co">#&gt; BEK_ica_overdecompose$names, : Small overlap between provided gene list and</span></a>
<a class="sourceLine" id="cb72-12" data-line-number="12"><span class="co">#&gt; gmt signatures: 5450/21320</span></a>
<a class="sourceLine" id="cb72-13" data-line-number="13"><span class="co">#&gt; saving metagenes</span></a>
<a class="sourceLine" id="cb72-14" data-line-number="14"><span class="co">#&gt; extracting top genes</span></a>
<a class="sourceLine" id="cb72-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb72-16" data-line-number="16"><span class="co">#&gt; running enrichment for: IC4</span></a>
<a class="sourceLine" id="cb72-17" data-line-number="17"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb72-18" data-line-number="18"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb72-19" data-line-number="19"><span class="co">#&gt; running enrichment for: IC28</span></a>
<a class="sourceLine" id="cb72-20" data-line-number="20"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb72-21" data-line-number="21"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb72-22" data-line-number="22"><span class="co">#&gt; running enrichment for: IC39</span></a>
<a class="sourceLine" id="cb72-23" data-line-number="23"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb72-24" data-line-number="24"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb72-25" data-line-number="25"><span class="co">#&gt; running enrichment for: IC49</span></a>
<a class="sourceLine" id="cb72-26" data-line-number="26"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb72-27" data-line-number="27"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb72-28" data-line-number="28"><span class="co">#&gt; running enrichment for: IC68</span></a>
<a class="sourceLine" id="cb72-29" data-line-number="29"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb72-30" data-line-number="30"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb72-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb72-32" data-line-number="32"><span class="co">#&gt; DONE</span></a></code></pre>
<pre class="sourceCode r" id="cb73"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">names</span>(enrichment.immune)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="co">#&gt; [1] &quot;metagenes&quot;  &quot;genes.list&quot; &quot;enrichment&quot;</span></a></code></pre>
<p>Output of <code>gene_enrichment_test()</code> is a list of three different elements for each component passing fixed p-value threshold. <code>metagenes</code> is a weighted list of top <em>n</em> genes, <code>genes.list</code> is character vector of top <em>n</em> genes and <code>enrichment</code>is enrichment test result</p>
<pre class="sourceCode r" id="cb74"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">enrichment.immune<span class="op">$</span>metagenes<span class="op">$</span>IC4[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="co">#&gt;           gene.names      IC4</span></a>
<a class="sourceLine" id="cb74-3" data-line-number="3"><span class="co">#&gt; IGLV1-44    IGLV1-44 29.53511</span></a>
<a class="sourceLine" id="cb74-4" data-line-number="4"><span class="co">#&gt; JCHAIN        JCHAIN 23.49211</span></a>
<a class="sourceLine" id="cb74-5" data-line-number="5"><span class="co">#&gt; IGKV1D-13  IGKV1D-13 22.57536</span></a>
<a class="sourceLine" id="cb74-6" data-line-number="6"><span class="co">#&gt; IGLJ3          IGLJ3 22.20133</span></a>
<a class="sourceLine" id="cb74-7" data-line-number="7"><span class="co">#&gt; IGHM            IGHM 20.92393</span></a>
<a class="sourceLine" id="cb74-8" data-line-number="8"><span class="co">#&gt; POU2AF1      POU2AF1 20.50039</span></a>
<a class="sourceLine" id="cb74-9" data-line-number="9"><span class="co">#&gt; IGLV@          IGLV@ 20.45265</span></a>
<a class="sourceLine" id="cb74-10" data-line-number="10"><span class="co">#&gt; IGLC1          IGLC1 20.42825</span></a>
<a class="sourceLine" id="cb74-11" data-line-number="11"><span class="co">#&gt; IGH              IGH 20.20349</span></a>
<a class="sourceLine" id="cb74-12" data-line-number="12"><span class="co">#&gt; IGHD            IGHD 19.02722</span></a></code></pre>
<pre class="sourceCode r" id="cb75"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">enrichment.immune<span class="op">$</span>genes.list<span class="op">$</span>IC4[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb75-2" data-line-number="2"><span class="co">#&gt;  [1] &quot;JCHAIN&quot;  &quot;POU2AF1&quot; &quot;FAM46C&quot;  &quot;MZB1&quot;    &quot;SLAMF7&quot;  &quot;CD38&quot;    &quot;IRF4&quot;   </span></a>
<a class="sourceLine" id="cb75-3" data-line-number="3"><span class="co">#&gt;  [8] &quot;CD79A&quot;   &quot;SEL1L3&quot;  &quot;CXCL9&quot;</span></a></code></pre>
<pre class="sourceCode r" id="cb76"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">kable</span>(enrichment.immune<span class="op">$</span>enrichment<span class="op">$</span>IC4[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,], <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
module
</th>
<th style="text-align:left;">
module_size
</th>
<th style="text-align:left;">
nb_genes_in_module
</th>
<th style="text-align:left;">
genes_in_module
</th>
<th style="text-align:right;">
universe_size
</th>
<th style="text-align:right;">
nb_genes_in_universe
</th>
<th style="text-align:left;">
p.value
</th>
<th style="text-align:right;">
p.value.corrected
</th>
<th style="text-align:left;">
test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
gamma.delta.T.cells
</td>
<td style="text-align:left;">
926
</td>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
JCHAIN POU2AF1 FAM46C MZB1 SLAMF7 CD38 IRF4 CD79A SEL1L3 CXCL9 AMPD1 CD27 PDK1 RBP1 LAX1 PIM2 CHI3L1 CYTIP RASSF6 UBD LTF CCL5
</td>
<td style="text-align:right;">
5723
</td>
<td style="text-align:right;">
5450
</td>
<td style="text-align:left;">
5.52377910001422e-17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha.beta.T.cells
</td>
<td style="text-align:left;">
432
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
JCHAIN POU2AF1 FAM46C MZB1 SLAMF7 CD38 IRF4 CD79A SEL1L3 CXCL9 AMPD1 CD27 PDK1 RBP1 LAX1 PIM2 CHI3L1 CYTIP RASSF6 UBD LTF
</td>
<td style="text-align:right;">
5723
</td>
<td style="text-align:right;">
5450
</td>
<td style="text-align:left;">
3.34922808722385e-16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Myeloid.Cells
</td>
<td style="text-align:left;">
952
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
JCHAIN POU2AF1 FAM46C MZB1 SLAMF7 CD38 IRF4 CD79A SEL1L3 CXCL9 AMPD1 CD27 PDK1 RBP1 LAX1 PIM2 CHI3L1 CYTIP RASSF6 UBD LTF
</td>
<td style="text-align:right;">
5723
</td>
<td style="text-align:right;">
5450
</td>
<td style="text-align:left;">
3.34922808722385e-16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
greater
</td>
</tr>
</tbody>
</table>
<p>If you use ImmgenHUGO list of signatures, <code>cell_voting_immgen()</code>can be used to summarize results.</p>
<pre class="sourceCode r" id="cb77"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">kable</span>(</a>
<a class="sourceLine" id="cb77-2" data-line-number="2">  <span class="kw">cell_voting_immgen</span>(enrichment.immune<span class="op">$</span>enrichment)<span class="op">$</span>IC4,</a>
<a class="sourceLine" id="cb77-3" data-line-number="3">  <span class="st">&quot;html&quot;</span>,</a>
<a class="sourceLine" id="cb77-4" data-line-number="4">  <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb77-5" data-line-number="5">  <span class="dt">caption =</span> <span class="st">&quot;IC4&quot;</span></a>
<a class="sourceLine" id="cb77-6" data-line-number="6">  )</a></code></pre>
<table>
<caption>
IC4
</caption>
<thead>
<tr>
<th style="text-align:left;">
cell.type
</th>
<th style="text-align:left;">
vote
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
NK.cells
</td>
<td style="text-align:left;">
68.21 %
</td>
</tr>
<tr>
<td style="text-align:left;">
gamma.delta.T.cells
</td>
<td style="text-align:left;">
20.84 %
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha.beta.T.cells
</td>
<td style="text-align:left;">
8.27 %
</td>
</tr>
<tr>
<td style="text-align:left;">
Myeloid.Cells
</td>
<td style="text-align:left;">
2.68 %
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb78"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">kable</span>(</a>
<a class="sourceLine" id="cb78-2" data-line-number="2">  <span class="kw">cell_voting_immgen</span>(enrichment.immune<span class="op">$</span>enrichment)<span class="op">$</span>IC28,</a>
<a class="sourceLine" id="cb78-3" data-line-number="3">  <span class="st">&quot;html&quot;</span>,</a>
<a class="sourceLine" id="cb78-4" data-line-number="4">  <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb78-5" data-line-number="5">  <span class="dt">caption =</span> <span class="kw">paste</span>(<span class="st">&quot;IC28&quot;</span>)</a>
<a class="sourceLine" id="cb78-6" data-line-number="6">  )</a></code></pre>
<table>
<caption>
IC28
</caption>
<thead>
<tr>
<th style="text-align:left;">
cell.type
</th>
<th style="text-align:left;">
vote
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Stromal.Cells
</td>
<td style="text-align:left;">
75.22 %
</td>
</tr>
<tr>
<td style="text-align:left;">
B.cells
</td>
<td style="text-align:left;">
15.91 %
</td>
</tr>
<tr>
<td style="text-align:left;">
Myeloid.Cells
</td>
<td style="text-align:left;">
8.87 %
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb79"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw">kable</span>(</a>
<a class="sourceLine" id="cb79-2" data-line-number="2">  <span class="kw">cell_voting_immgen</span>(enrichment.immune<span class="op">$</span>enrichment)<span class="op">$</span>IC39,</a>
<a class="sourceLine" id="cb79-3" data-line-number="3">  <span class="st">&quot;html&quot;</span>,</a>
<a class="sourceLine" id="cb79-4" data-line-number="4">  <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb79-5" data-line-number="5">  <span class="dt">caption =</span> <span class="kw">paste</span>(<span class="st">&quot;IC39&quot;</span>)</a>
<a class="sourceLine" id="cb79-6" data-line-number="6">  )</a></code></pre>
<table>
<caption>
IC39
</caption>
<thead>
<tr>
<th style="text-align:left;">
cell.type
</th>
<th style="text-align:left;">
vote
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
gamma.delta.T.cells
</td>
<td style="text-align:left;">
71.58 %
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha.beta.T.cells
</td>
<td style="text-align:left;">
28.42 %
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb80"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="kw">kable</span>(</a>
<a class="sourceLine" id="cb80-2" data-line-number="2">  <span class="kw">cell_voting_immgen</span>(enrichment.immune<span class="op">$</span>enrichment)<span class="op">$</span>IC49,</a>
<a class="sourceLine" id="cb80-3" data-line-number="3">  <span class="st">&quot;html&quot;</span>,</a>
<a class="sourceLine" id="cb80-4" data-line-number="4">  <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb80-5" data-line-number="5">  <span class="dt">caption =</span> <span class="kw">paste</span>(<span class="st">&quot;IC49&quot;</span>)</a>
<a class="sourceLine" id="cb80-6" data-line-number="6">  )</a></code></pre>
<table>
<caption>
IC49
</caption>
<thead>
<tr>
<th style="text-align:left;">
cell.type
</th>
<th style="text-align:left;">
vote
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Myeloid.Cells
</td>
<td style="text-align:left;">
100 %
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb81"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">kable</span>(</a>
<a class="sourceLine" id="cb81-2" data-line-number="2">  <span class="kw">cell_voting_immgen</span>(enrichment.immune<span class="op">$</span>enrichment)<span class="op">$</span>IC68,</a>
<a class="sourceLine" id="cb81-3" data-line-number="3">  <span class="st">&quot;html&quot;</span>,</a>
<a class="sourceLine" id="cb81-4" data-line-number="4">  <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb81-5" data-line-number="5">  <span class="dt">caption =</span> <span class="kw">paste</span>(<span class="st">&quot;IC68&quot;</span>)</a>
<a class="sourceLine" id="cb81-6" data-line-number="6">  )</a></code></pre>
<table>
<caption>
IC68
</caption>
<thead>
<tr>
<th style="text-align:left;">
cell.type
</th>
<th style="text-align:left;">
vote
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
gamma.delta.T.cells
</td>
<td style="text-align:left;">
57.6 %
</td>
</tr>
<tr>
<td style="text-align:left;">
Stromal.Cells
</td>
<td style="text-align:left;">
23.56 %
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha.beta.T.cells
</td>
<td style="text-align:left;">
11.43 %
</td>
</tr>
<tr>
<td style="text-align:left;">
Myeloid.Cells
</td>
<td style="text-align:left;">
7.41 %
</td>
</tr>
</tbody>
</table>
<p>This result is not trivial to interpret.</p>
<p>A different .gmt can be also used to perform the enrichment analysis.</p>
<p>We can import for example signature genes from <em>TIMER</em> <span class="citation">(Li et al. 2016)</span></p>
<pre class="sourceCode r" id="cb82"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">setwd</span>(<span class="kw">path.package</span>(<span class="st">&quot;deconica&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb82-2" data-line-number="2">TIMER &lt;-</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="st">  </span>ACSNMineR<span class="op">::</span><span class="kw">format_from_gmt</span>(<span class="st">&quot;./data-raw/TIMER_cellTypes.gmt&quot;</span>)</a></code></pre>
<pre class="sourceCode r" id="cb83"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">enrichment.immune &lt;-<span class="st"> </span><span class="kw">gene_enrichment_test</span>(</a>
<a class="sourceLine" id="cb83-2" data-line-number="2">  BEK_ica_overdecompose<span class="op">$</span>S,</a>
<a class="sourceLine" id="cb83-3" data-line-number="3">  BEK_ica_overdecompose<span class="op">$</span>names,</a>
<a class="sourceLine" id="cb83-4" data-line-number="4">  <span class="dt">immune.ics =</span> <span class="kw">names</span>(immune.components),</a>
<a class="sourceLine" id="cb83-5" data-line-number="5">  <span class="dt">gmt =</span> TIMER,</a>
<a class="sourceLine" id="cb83-6" data-line-number="6">  <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,</a>
<a class="sourceLine" id="cb83-7" data-line-number="7">  <span class="dt">p.adjust.method =</span> <span class="st">&quot;BH&quot;</span>,</a>
<a class="sourceLine" id="cb83-8" data-line-number="8">  <span class="dt">p.value.threshold =</span> <span class="fl">0.05</span></a>
<a class="sourceLine" id="cb83-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb83-10" data-line-number="10"><span class="co">#&gt; 1 modules higher than threshold: 500</span></a>
<a class="sourceLine" id="cb83-11" data-line-number="11"><span class="co">#&gt; Warning in gene_enrichment_test(BEK_ica_overdecompose$S,</span></a>
<a class="sourceLine" id="cb83-12" data-line-number="12"><span class="co">#&gt; BEK_ica_overdecompose$names, : Small overlap between provided gene list and</span></a>
<a class="sourceLine" id="cb83-13" data-line-number="13"><span class="co">#&gt; gmt signatures: 673/21320</span></a>
<a class="sourceLine" id="cb83-14" data-line-number="14"><span class="co">#&gt; saving metagenes</span></a>
<a class="sourceLine" id="cb83-15" data-line-number="15"><span class="co">#&gt; extracting top genes</span></a>
<a class="sourceLine" id="cb83-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb83-17" data-line-number="17"><span class="co">#&gt; running enrichment for: IC4</span></a>
<a class="sourceLine" id="cb83-18" data-line-number="18"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb83-19" data-line-number="19"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb83-20" data-line-number="20"><span class="co">#&gt; running enrichment for: IC28</span></a>
<a class="sourceLine" id="cb83-21" data-line-number="21"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb83-22" data-line-number="22"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb83-23" data-line-number="23"><span class="co">#&gt; running enrichment for: IC39</span></a>
<a class="sourceLine" id="cb83-24" data-line-number="24"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb83-25" data-line-number="25"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb83-26" data-line-number="26"><span class="co">#&gt; running enrichment for: IC49</span></a>
<a class="sourceLine" id="cb83-27" data-line-number="27"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb83-28" data-line-number="28"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb83-29" data-line-number="29"><span class="co">#&gt; running enrichment for: IC68</span></a>
<a class="sourceLine" id="cb83-30" data-line-number="30"><span class="co">#&gt; correcting p.values</span></a>
<a class="sourceLine" id="cb83-31" data-line-number="31"><span class="co">#&gt; applying p.value.threshold</span></a>
<a class="sourceLine" id="cb83-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb83-33" data-line-number="33"><span class="co">#&gt; DONE</span></a></code></pre>
<pre class="sourceCode r" id="cb84"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">kable</span>(enrichment.immune<span class="op">$</span>enrichment<span class="op">$</span>IC4, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">caption =</span> <span class="st">&quot;IC4&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
IC4
</caption>
<thead>
<tr>
<th style="text-align:left;">
module
</th>
<th style="text-align:left;">
module_size
</th>
<th style="text-align:left;">
nb_genes_in_module
</th>
<th style="text-align:left;">
genes_in_module
</th>
<th style="text-align:right;">
universe_size
</th>
<th style="text-align:right;">
nb_genes_in_universe
</th>
<th style="text-align:left;">
p.value
</th>
<th style="text-align:right;">
p.value.corrected
</th>
<th style="text-align:left;">
test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Lymphoid
</td>
<td style="text-align:left;">
234
</td>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
POU2AF1 TNFRSF17 FCRL5 CD79A AMPD1 CD27 PDK1 PIM2 CHI3L1 CPNE5 PNOC FKBP11 IDO1 CD2 CXCL11 CEP128 ELL2 EAF2 CD8A MANEA ITK MMP12 LCK CCND2 CYP1B1 NLRC3 TFPI2 GZMK CD274 UBE2J1 GZMA MS4A1 CD19 KLF12 CCL19 EOMES AIM2 FAM30A HSPA13 NKG7 SDF2L1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
7.9891782953872e-33
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
B Cell
</td>
<td style="text-align:left;">
91
</td>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
POU2AF1 TNFRSF17 FCRL5 CD79A AMPD1 CD27 PDK1 PIM2 CHI3L1 CPNE5 PNOC FKBP11 IDO1 CD2 CXCL11 CEP128 ELL2 EAF2 CD8A MANEA ITK MMP12
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
5.52377910001422e-17
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Myeloid
</td>
<td style="text-align:left;">
344
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
POU2AF1 TNFRSF17 FCRL5 CD79A AMPD1 CD27 PDK1 PIM2 CHI3L1 CPNE5 PNOC FKBP11 IDO1 CD2 CXCL11 CEP128 ELL2 EAF2
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
7.01437884551178e-14
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
T Cell
</td>
<td style="text-align:left;">
76
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
POU2AF1 TNFRSF17 FCRL5 CD79A AMPD1 CD27 PDK1 PIM2 CHI3L1 CPNE5
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
7.04213335186756e-08
</td>
<td style="text-align:right;">
0.0000002
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
795
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
POU2AF1 TNFRSF17 FCRL5 CD79A AMPD1 CD27 PDK1 PIM2 CHI3L1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
3.79965656677689e-07
</td>
<td style="text-align:right;">
0.0000007
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic Cell
</td>
<td style="text-align:left;">
70
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
POU2AF1 TNFRSF17 FCRL5 CD79A AMPD1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.000294962142828159
</td>
<td style="text-align:right;">
0.0003792
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Neutrophil
</td>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
POU2AF1 TNFRSF17 FCRL5 CD79A AMPD1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.000294962142828159
</td>
<td style="text-align:right;">
0.0003792
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:left;">
82
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
POU2AF1 TNFRSF17 FCRL5
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.00780838786005748
</td>
<td style="text-align:right;">
0.0087844
</td>
<td style="text-align:left;">
greater
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb85"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">kable</span>(enrichment.immune<span class="op">$</span>enrichment<span class="op">$</span>IC28, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">caption =</span> <span class="st">&quot;IC28&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
IC28
</caption>
<thead>
<tr>
<th style="text-align:left;">
module
</th>
<th style="text-align:left;">
module_size
</th>
<th style="text-align:left;">
nb_genes_in_module
</th>
<th style="text-align:left;">
genes_in_module
</th>
<th style="text-align:right;">
universe_size
</th>
<th style="text-align:right;">
nb_genes_in_universe
</th>
<th style="text-align:left;">
p.value
</th>
<th style="text-align:right;">
p.value.corrected
</th>
<th style="text-align:left;">
test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Myeloid
</td>
<td style="text-align:left;">
344
</td>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
MMP12 MS4A1 SPIB MMP9 CXCL5 SGPP2 BCL11A KRT23 P2RX5 CHI3L1 CYP1B1 WNT5A IL32 CD19 RASSF4 POU2AF1 NRIP3 CD1A BCL2A1 ACP5 FCMR SERPINB2 CCL19 IRAK2 GPR18 FCRL5 KYNU ARL4C STAP1 TRIM59 NLRP7
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
3.02686371304923e-24
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Lymphoid
</td>
<td style="text-align:left;">
234
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
MMP12 MS4A1 SPIB MMP9 CXCL5 SGPP2 BCL11A KRT23 P2RX5 CHI3L1 CYP1B1 WNT5A IL32 CD19 RASSF4 POU2AF1 NRIP3 CD1A BCL2A1 ACP5 FCMR SERPINB2 CCL19 IRAK2
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
1.45504141446656e-18
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
B Cell
</td>
<td style="text-align:left;">
91
</td>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
MMP12 MS4A1 SPIB MMP9 CXCL5 SGPP2 BCL11A KRT23 P2RX5 CHI3L1 CYP1B1 WNT5A IL32 CD19 RASSF4 POU2AF1 NRIP3 CD1A BCL2A1 ACP5
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
2.00953685233431e-15
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:left;">
82
</td>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
MMP12 MS4A1 SPIB MMP9 CXCL5 SGPP2 BCL11A KRT23 P2RX5 CHI3L1 CYP1B1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
1.29345306462873e-08
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic Cell
</td>
<td style="text-align:left;">
70
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
MMP12 MS4A1 SPIB MMP9 CXCL5 SGPP2 BCL11A KRT23 P2RX5 CHI3L1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
7.04213335186756e-08
</td>
<td style="text-align:right;">
0.0000001
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
795
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
MMP12 MS4A1 SPIB MMP9 CXCL5 SGPP2 BCL11A KRT23 P2RX5 CHI3L1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
7.04213335186756e-08
</td>
<td style="text-align:right;">
0.0000001
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
T Cell
</td>
<td style="text-align:left;">
76
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
MMP12 MS4A1 SPIB MMP9 CXCL5
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.000294962142828159
</td>
<td style="text-align:right;">
0.0003792
</td>
<td style="text-align:left;">
greater
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb86"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="kw">kable</span>(enrichment.immune<span class="op">$</span>enrichment<span class="op">$</span>IC39, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">caption =</span> <span class="st">&quot;IC39&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
IC39
</caption>
<thead>
<tr>
<th style="text-align:left;">
module
</th>
<th style="text-align:left;">
module_size
</th>
<th style="text-align:left;">
nb_genes_in_module
</th>
<th style="text-align:left;">
genes_in_module
</th>
<th style="text-align:right;">
universe_size
</th>
<th style="text-align:right;">
nb_genes_in_universe
</th>
<th style="text-align:left;">
p.value
</th>
<th style="text-align:right;">
p.value.corrected
</th>
<th style="text-align:left;">
test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Lymphoid
</td>
<td style="text-align:left;">
234
</td>
<td style="text-align:left;">
50
</td>
<td style="text-align:left;">
MS4A1 CCL19 FCRL3 MMP9 GPR18 EOMES NLRC3 GZMK BCL11B ITK LCK FCMR CD2 TCL1A TMC8 CD19 CD247 CD3E IL2RB CD3D GZMA CD27 P2RX5 CD69 POU2AF1 PTX3 CD8A GZMB RASGRP2 SPIB SAMD3 STAT4 MAP4K1 BANK1 PTPN7 ZAP70 TRAT1 TLR10 PTPRCAP FCRL1 CD79A KRT23 GNLY NKG7 MYBL1 KLRG1 RASSF2 BCL11A KLRB1 CD6
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
4.35924427142961e-41
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
T Cell
</td>
<td style="text-align:left;">
76
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
MS4A1 CCL19 FCRL3 MMP9 GPR18 EOMES NLRC3 GZMK BCL11B ITK LCK FCMR CD2 TCL1A TMC8
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
1.34198340448245e-11
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
B Cell
</td>
<td style="text-align:left;">
91
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
MS4A1 CCL19 FCRL3 MMP9 GPR18 EOMES NLRC3 GZMK BCL11B ITK LCK FCMR CD2
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
4.24516594680188e-10
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Myeloid
</td>
<td style="text-align:left;">
344
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
MS4A1 CCL19 FCRL3 MMP9 GPR18 EOMES NLRC3 GZMK BCL11B ITK LCK FCMR CD2
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
4.24516594680188e-10
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
795
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
MS4A1 CCL19 FCRL3 MMP9 GPR18 EOMES NLRC3 GZMK
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
2.03199025092851e-06
</td>
<td style="text-align:right;">
0.0000037
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:left;">
82
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
MS4A1 CCL19 FCRL3 MMP9 GPR18
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.000294962142828159
</td>
<td style="text-align:right;">
0.0004424
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic Cell
</td>
<td style="text-align:left;">
70
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
MS4A1 CCL19 FCRL3 MMP9
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.00152397107127882
</td>
<td style="text-align:right;">
0.0019594
</td>
<td style="text-align:left;">
greater
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb87"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">kable</span>(enrichment.immune<span class="op">$</span>enrichment<span class="op">$</span>IC49, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">caption =</span> <span class="st">&quot;IC49&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
IC49
</caption>
<thead>
<tr>
<th style="text-align:left;">
module
</th>
<th style="text-align:left;">
module_size
</th>
<th style="text-align:left;">
nb_genes_in_module
</th>
<th style="text-align:left;">
genes_in_module
</th>
<th style="text-align:right;">
universe_size
</th>
<th style="text-align:right;">
nb_genes_in_universe
</th>
<th style="text-align:left;">
p.value
</th>
<th style="text-align:right;">
p.value.corrected
</th>
<th style="text-align:left;">
test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Myeloid
</td>
<td style="text-align:left;">
344
</td>
<td style="text-align:left;">
69
</td>
<td style="text-align:left;">
FCGR3B FGL2 FCGR2B TLR8 CPVL MPEG1 CD86 CYBB TLR1 MNDA MS4A6A FPR3 CSF1R P2RX7 GGTA1P TFEC CXCL11 HLA-DRB4 NCF2 P2RY13 HCK TLR2 C5AR1 MS4A7 THEMIS2 CSF2RA CLEC5A CLEC7A KCTD12 RASSF4 IGSF6 EMILIN2 AIF1 SLAMF8 PILRA TREM2 DSE NCF4 DPYD GZMA FPR1 CPM NPL LILRB2 TNFSF13B ARHGAP18 ADAP2 STAB1 HPSE PTAFR LYN LILRB1 AP1S2 HSPA6 HMOX1 SIGLEC1 SLC15A3 CD8A KYNU DFNA5 TNFAIP2 MAN1A1 MMP1 CLIC2 CD69 XCL1 IL15 SOD2 MAFB
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
9.19957214014236e-61
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Lymphoid
</td>
<td style="text-align:left;">
234
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
FCGR3B FGL2 FCGR2B TLR8 CPVL MPEG1 CD86 CYBB TLR1 MNDA
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
7.04213335186756e-08
</td>
<td style="text-align:right;">
0.0000002
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:left;">
82
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
FCGR3B FGL2 FCGR2B TLR8 CPVL MPEG1 CD86 CYBB TLR1 MNDA
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
7.04213335186756e-08
</td>
<td style="text-align:right;">
0.0000002
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic Cell
</td>
<td style="text-align:left;">
70
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
FCGR3B FGL2 FCGR2B TLR8 CPVL MPEG1 CD86 CYBB TLR1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
3.79965656677689e-07
</td>
<td style="text-align:right;">
0.0000009
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
795
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
FCGR3B FGL2 FCGR2B TLR8 CPVL MPEG1
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
5.66088960983336e-05
</td>
<td style="text-align:right;">
0.0001019
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Neutrophil
</td>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
FCGR3B FGL2 FCGR2B TLR8
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.00152397107127882
</td>
<td style="text-align:right;">
0.0022860
</td>
<td style="text-align:left;">
greater
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r" id="cb88"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw">kable</span>(enrichment.immune<span class="op">$</span>enrichment<span class="op">$</span>IC68, <span class="st">&quot;html&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">caption =</span> <span class="st">&quot;IC68&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-2" data-line-number="2"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">8</span>)</a></code></pre>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
IC68
</caption>
<thead>
<tr>
<th style="text-align:left;">
module
</th>
<th style="text-align:left;">
module_size
</th>
<th style="text-align:left;">
nb_genes_in_module
</th>
<th style="text-align:left;">
genes_in_module
</th>
<th style="text-align:right;">
universe_size
</th>
<th style="text-align:right;">
nb_genes_in_universe
</th>
<th style="text-align:left;">
p.value
</th>
<th style="text-align:right;">
p.value.corrected
</th>
<th style="text-align:left;">
test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Lymphoid
</td>
<td style="text-align:left;">
234
</td>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
PTGDR GZMB GZMK FCMR IL32 CD8A XCL2 GZMA NKG7 VCPKMT RIT1 IL2RB BCL11A ZBED2 XCL1 INHBA CD2 FCRL3 HSPA13 TNFRSF18 EOMES GNLY DUSP6 MS4A1 PLA2G7 TYMP ATP2B1 CD3D MANEA CAPG SAMD3 BTN3A2 LAG3 NLRC3 PRF1 OSBPL11 AIFM2 CCL19 SPRED2 ACER3 ZAP70 SPIB
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
1.0269314148755e-33
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Myeloid
</td>
<td style="text-align:left;">
344
</td>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
PTGDR GZMB GZMK FCMR IL32 CD8A XCL2 GZMA NKG7 VCPKMT RIT1 IL2RB BCL11A ZBED2 XCL1 INHBA CD2 FCRL3 HSPA13 TNFRSF18 EOMES GNLY DUSP6 MS4A1 PLA2G7
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
2.32317536763567e-19
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
B Cell
</td>
<td style="text-align:left;">
91
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
PTGDR GZMB GZMK FCMR IL32 CD8A XCL2 GZMA NKG7 VCPKMT RIT1 IL2RB BCL11A
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
4.24516594680188e-10
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
T Cell
</td>
<td style="text-align:left;">
76
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
PTGDR GZMB GZMK FCMR IL32 CD8A XCL2 GZMA NKG7 VCPKMT RIT1 IL2RB BCL11A
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
4.24516594680188e-10
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic Cell
</td>
<td style="text-align:left;">
70
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
PTGDR GZMB GZMK FCMR IL32 CD8A XCL2 GZMA NKG7
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
3.79965656677689e-07
</td>
<td style="text-align:right;">
0.0000006
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
795
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
PTGDR GZMB GZMK FCMR IL32 CD8A XCL2 GZMA NKG7
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
3.79965656677689e-07
</td>
<td style="text-align:right;">
0.0000006
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Neutrophil
</td>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
PTGDR GZMB GZMK
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.00780838786005748
</td>
<td style="text-align:right;">
0.0100394
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:left;">
82
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
PTGDR GZMB
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.0396793587174349
</td>
<td style="text-align:right;">
0.0396794
</td>
<td style="text-align:left;">
greater
</td>
</tr>
<tr>
<td style="text-align:left;">
NK Cell
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
PTGDR GZMB
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
673
</td>
<td style="text-align:left;">
0.0396793587174349
</td>
<td style="text-align:right;">
0.0396794
</td>
<td style="text-align:left;">
greater
</td>
</tr>
</tbody>
</table>
<p>Based on this results we can suppose that:</p>
<ul>
<li>IC4 is related to B-cells</li>
<li>IC49 and IC68 are related to Myeloid cells</li>
<li>IC39 is related to T-cells</li>
<li>IC28 can be characterized as stroma</li>
</ul>
<p>This result can be cross-verified with radar plot and maximal correlations with LM22</p>
<pre class="sourceCode r" id="cb89"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="co">#retrieve max correlations</span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"> max.corr &lt;-<span class="st"> </span><span class="kw">get_max_correlations</span>(corr_LM22)</a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="co"># order</span></a>
<a class="sourceLine" id="cb89-4" data-line-number="4"> max.corr.ordered &lt;-<span class="st"> </span>max.corr[<span class="kw">order</span>(<span class="op">-</span>max.corr<span class="op">$</span>r),]</a>
<a class="sourceLine" id="cb89-5" data-line-number="5"><span class="co"># show table</span></a>
<a class="sourceLine" id="cb89-6" data-line-number="6"><span class="kw">kable</span>(max.corr.ordered, <span class="st">&quot;html&quot;</span>,<span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
TYPE
</th>
<th style="text-align:left;">
IC
</th>
<th style="text-align:right;">
r
</th>
<th style="text-align:right;">
p.val
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Plasma.cells
</td>
<td style="text-align:left;">
IC4
</td>
<td style="text-align:right;">
0.7880667
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD8
</td>
<td style="text-align:left;">
IC39
</td>
<td style="text-align:right;">
0.4987960
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD4.naive
</td>
<td style="text-align:left;">
IC39
</td>
<td style="text-align:right;">
0.4705819
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD4.memory.resting
</td>
<td style="text-align:left;">
IC39
</td>
<td style="text-align:right;">
0.4691812
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
B.cells.naive
</td>
<td style="text-align:left;">
IC4
</td>
<td style="text-align:right;">
0.4644702
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
B.cells.memory
</td>
<td style="text-align:left;">
IC4
</td>
<td style="text-align:right;">
0.4598657
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.follicular.helper
</td>
<td style="text-align:left;">
IC39
</td>
<td style="text-align:right;">
0.4300112
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.gamma.delta
</td>
<td style="text-align:left;">
IC39
</td>
<td style="text-align:right;">
0.3949245
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.regulatory..Tregs.
</td>
<td style="text-align:left;">
IC39
</td>
<td style="text-align:right;">
0.3940503
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Macrophages.M2
</td>
<td style="text-align:left;">
IC49
</td>
<td style="text-align:right;">
0.3654883
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Macrophages.M1
</td>
<td style="text-align:left;">
IC3
</td>
<td style="text-align:right;">
0.3499043
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic.cells.resting
</td>
<td style="text-align:left;">
IC61
</td>
<td style="text-align:right;">
0.3447491
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Neutrophils
</td>
<td style="text-align:left;">
IC49
</td>
<td style="text-align:right;">
0.3371526
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
NK.cells.resting
</td>
<td style="text-align:left;">
IC68
</td>
<td style="text-align:right;">
0.3338840
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Dendritic.cells.activated
</td>
<td style="text-align:left;">
IC3
</td>
<td style="text-align:right;">
0.3332215
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Mast.cells.resting
</td>
<td style="text-align:left;">
IC56
</td>
<td style="text-align:right;">
0.3168765
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Monocytes
</td>
<td style="text-align:left;">
IC49
</td>
<td style="text-align:right;">
0.3099286
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Macrophages.M0
</td>
<td style="text-align:left;">
IC61
</td>
<td style="text-align:right;">
0.3073292
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
T.cells.CD4.memory.activated
</td>
<td style="text-align:left;">
IC39
</td>
<td style="text-align:right;">
0.3059700
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
NK.cells.activated
</td>
<td style="text-align:left;">
IC68
</td>
<td style="text-align:right;">
0.2991302
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Eosinophils
</td>
<td style="text-align:left;">
IC42
</td>
<td style="text-align:right;">
0.2613817
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
Mast.cells.activated
</td>
<td style="text-align:left;">
IC56
</td>
<td style="text-align:right;">
0.2329371
</td>
<td style="text-align:right;">
1e-07
</td>
</tr>
</tbody>
</table>
<p>Indeed from correlation with LM22 we learn that</p>
<ul>
<li>IC4 is related to B-cells</li>
<li>IC39 to T-cells</li>
<li>IC49 to M2 Macrophages, Monocytes and Neutrophils</li>
<li>IC68 to NK</li>
</ul>
</div>
<div id="estimate-abundance" class="section level4">
<h4>Estimate abundance</h4>
<p>Once we identified components related to the immune cells, we can use them to extract <em>specific</em> markers, best number of markers usually vary from 10 to 30</p>
<pre class="sourceCode r" id="cb90"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">markers_<span class="dv">10</span> &lt;-</a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="st">  </span><span class="kw">generate_markers</span>(</a>
<a class="sourceLine" id="cb90-3" data-line-number="3">    <span class="dt">df =</span> BEK_ica_overdecompose,</a>
<a class="sourceLine" id="cb90-4" data-line-number="4">    <span class="dt">n =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb90-5" data-line-number="5">    <span class="dt">sel.comp =</span> <span class="kw">names</span>(immune.components),</a>
<a class="sourceLine" id="cb90-6" data-line-number="6">    <span class="dt">return =</span> <span class="st">&quot;gene.list&quot;</span></a>
<a class="sourceLine" id="cb90-7" data-line-number="7">  )</a></code></pre>
<pre class="sourceCode r" id="cb91"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">markers_<span class="dv">10</span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="co">#&gt; $IC4</span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="co">#&gt;  [1] &quot;IGLV1-44&quot;  &quot;JCHAIN&quot;    &quot;IGKV1D-13&quot; &quot;IGLJ3&quot;     &quot;IGHM&quot;     </span></a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="co">#&gt;  [6] &quot;POU2AF1&quot;   &quot;IGLV@&quot;     &quot;IGLC1&quot;     &quot;IGH&quot;       &quot;IGHD&quot;     </span></a>
<a class="sourceLine" id="cb91-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb91-6" data-line-number="6"><span class="co">#&gt; $IC28</span></a>
<a class="sourceLine" id="cb91-7" data-line-number="7"><span class="co">#&gt;  [1] &quot;FDCSP&quot;  &quot;CSN3&quot;   &quot;GABRP&quot;  &quot;MMP12&quot;  &quot;CAPN6&quot;  &quot;KRT6B&quot;  &quot;SOX10&quot; </span></a>
<a class="sourceLine" id="cb91-8" data-line-number="8"><span class="co">#&gt;  [8] &quot;LPL&quot;    &quot;ODAM&quot;   &quot;FERMT1&quot;</span></a>
<a class="sourceLine" id="cb91-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb91-10" data-line-number="10"><span class="co">#&gt; $IC39</span></a>
<a class="sourceLine" id="cb91-11" data-line-number="11"><span class="co">#&gt;  [1] &quot;MS4A1&quot;  &quot;CXCL13&quot; &quot;CCL19&quot;  &quot;CCR7&quot;   &quot;SELL&quot;   &quot;FCRL3&quot;  &quot;PAX5&quot;  </span></a>
<a class="sourceLine" id="cb91-12" data-line-number="12"><span class="co">#&gt;  [8] &quot;SCML4&quot;  &quot;MMP9&quot;   &quot;GPR18&quot; </span></a>
<a class="sourceLine" id="cb91-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb91-14" data-line-number="14"><span class="co">#&gt; $IC49</span></a>
<a class="sourceLine" id="cb91-15" data-line-number="15"><span class="co">#&gt;  [1] &quot;FCGR3B&quot;   &quot;MS4A4A&quot;   &quot;MSR1&quot;     &quot;GPR34&quot;    &quot;MRC1&quot;     &quot;CD163&quot;   </span></a>
<a class="sourceLine" id="cb91-16" data-line-number="16"><span class="co">#&gt;  [7] &quot;FGL2&quot;     &quot;HLA-DQA1&quot; &quot;VSIG4&quot;    &quot;HLA-DRA&quot; </span></a>
<a class="sourceLine" id="cb91-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb91-18" data-line-number="18"><span class="co">#&gt; $IC68</span></a>
<a class="sourceLine" id="cb91-19" data-line-number="19"><span class="co">#&gt;  [1] &quot;CST1&quot;   &quot;CST4&quot;   &quot;SHISA2&quot; &quot;CST2&quot;   &quot;KCNK1&quot;  &quot;CCND1&quot;  &quot;C8orf4&quot;</span></a>
<a class="sourceLine" id="cb91-20" data-line-number="20"><span class="co">#&gt;  [8] &quot;MUM1L1&quot; &quot;PTGDR&quot;  &quot;VSTM2A&quot;</span></a></code></pre>
<pre class="sourceCode r" id="cb92"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">basis_<span class="dv">10</span> &lt;-</a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="st">  </span><span class="kw">generate_basis</span>(</a>
<a class="sourceLine" id="cb92-3" data-line-number="3">    <span class="dt">df =</span> BEK_ica_overdecompose,</a>
<a class="sourceLine" id="cb92-4" data-line-number="4">    <span class="dt">sel.comp =</span> <span class="kw">names</span>(immune.components),</a>
<a class="sourceLine" id="cb92-5" data-line-number="5">    <span class="dt">markers =</span> markers_<span class="dv">10</span></a>
<a class="sourceLine" id="cb92-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb92-7" data-line-number="7">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(basis_<span class="dv">10</span>, <span class="dt">fontsize_row =</span> <span class="dv">8</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-121-1.png" /><!-- --> We can observe how it looks for <code>n = 30</code>(30 specific genes for each cell type - component)</p>
<pre class="sourceCode r" id="cb93"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">markers_<span class="dv">30</span> &lt;-</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="st">  </span><span class="kw">generate_markers</span>(</a>
<a class="sourceLine" id="cb93-3" data-line-number="3">    <span class="dt">df =</span> BEK_ica_overdecompose,</a>
<a class="sourceLine" id="cb93-4" data-line-number="4">    <span class="dt">n =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb93-5" data-line-number="5">    <span class="dt">sel.comp =</span> <span class="kw">names</span>(immune.components),</a>
<a class="sourceLine" id="cb93-6" data-line-number="6">    <span class="dt">return =</span> <span class="st">&quot;gene.list&quot;</span></a>
<a class="sourceLine" id="cb93-7" data-line-number="7">  )</a></code></pre>
<pre class="sourceCode r" id="cb94"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">basis_<span class="dv">30</span> &lt;-</a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="st">  </span><span class="kw">generate_basis</span>(</a>
<a class="sourceLine" id="cb94-3" data-line-number="3">    <span class="dt">df =</span> BEK_ica_overdecompose,</a>
<a class="sourceLine" id="cb94-4" data-line-number="4">    <span class="dt">sel.comp =</span> <span class="kw">names</span>(immune.components),</a>
<a class="sourceLine" id="cb94-5" data-line-number="5">    <span class="dt">markers =</span> markers_<span class="dv">30</span></a>
<a class="sourceLine" id="cb94-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb94-7" data-line-number="7">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(basis_<span class="dv">30</span>, <span class="dt">fontsize_row =</span> <span class="dv">6</span>)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-123-1.png" /><!-- --></p>
<p>And finally to obtain the abundance scores, a function <code>get_scores()</code>can be used.</p>
<p>If you want to use only gene.list</p>
<pre class="sourceCode r" id="cb95"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">get_scores</span> (BEK_ica_overdecompose<span class="op">$</span>counts, markers_<span class="dv">10</span>, <span class="dt">summary =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="co">#&gt;                 IC4      IC28      IC39     IC49     IC68</span></a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="co">#&gt; GSM585300 1015.6910  68.68907 142.01059 205.1942 283.7116</span></a>
<a class="sourceLine" id="cb95-4" data-line-number="4"><span class="co">#&gt; GSM585301 1309.1217 114.52619  64.02462 160.9249 316.5380</span></a>
<a class="sourceLine" id="cb95-5" data-line-number="5"><span class="co">#&gt; GSM585302 2484.4715 147.33433 561.32776 110.5064 117.8382</span></a>
<a class="sourceLine" id="cb95-6" data-line-number="6"><span class="co">#&gt; GSM585303 1641.7940  52.89996  38.92237  87.3892 208.3567</span></a>
<a class="sourceLine" id="cb95-7" data-line-number="7"><span class="co">#&gt; GSM585304  185.3009  26.68603  48.57868 128.0455 772.6966</span></a>
<a class="sourceLine" id="cb95-8" data-line-number="8"><span class="co">#&gt; GSM585305 5400.0182  98.54236 137.97633 388.9607 212.1527</span></a></code></pre>
<p>If you want to compute weighted mean (using ICA weights), first transform to a list of data frames:</p>
<pre class="sourceCode r" id="cb96"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">weighted.list_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">generate_markers</span>(</a>
<a class="sourceLine" id="cb96-2" data-line-number="2">  <span class="dt">df =</span> BEK_ica_overdecompose,</a>
<a class="sourceLine" id="cb96-3" data-line-number="3">  <span class="dt">n =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb96-4" data-line-number="4">  <span class="dt">sel.comp =</span> <span class="kw">names</span>(immune.components),</a>
<a class="sourceLine" id="cb96-5" data-line-number="5">  <span class="dt">return =</span> <span class="st">&quot;gene.ranked&quot;</span></a>
<a class="sourceLine" id="cb96-6" data-line-number="6">)</a></code></pre>
<pre class="sourceCode r" id="cb97"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">weighted.scores &lt;-<span class="st"> </span><span class="kw">get_scores</span> (BEK_ica_overdecompose<span class="op">$</span>counts, weighted.list_<span class="dv">10</span>, <span class="dt">summary =</span> <span class="st">&quot;weighted.mean&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="kw">head</span>(weighted.scores)</a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="co">#&gt;                 IC4      IC28      IC39      IC49      IC68</span></a>
<a class="sourceLine" id="cb97-4" data-line-number="4"><span class="co">#&gt; GSM585300  969.9797  57.51394 139.64727 194.54404 191.63500</span></a>
<a class="sourceLine" id="cb97-5" data-line-number="5"><span class="co">#&gt; GSM585301 1238.1501  93.36739  60.44216 152.94476 254.92725</span></a>
<a class="sourceLine" id="cb97-6" data-line-number="6"><span class="co">#&gt; GSM585302 2386.5932 147.70302 592.17641 102.79626  95.21841</span></a>
<a class="sourceLine" id="cb97-7" data-line-number="7"><span class="co">#&gt; GSM585303 1557.1738  41.40888  38.99046  79.37605 201.52527</span></a>
<a class="sourceLine" id="cb97-8" data-line-number="8"><span class="co">#&gt; GSM585304  176.4919  21.41715  39.03719 123.14515 578.01167</span></a>
<a class="sourceLine" id="cb97-9" data-line-number="9"><span class="co">#&gt; GSM585305 5195.6869  79.47580 119.84810 346.11541 138.89664</span></a></code></pre>
<p>These scores are linearly correlated with proportion values of each cell type in samples.</p>
<p>We can rename columns according to labels we attributed</p>
<pre class="sourceCode r" id="cb98"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="kw">colnames</span>(weighted.scores) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;B-cell&quot;</span>, <span class="st">&quot;Stroma&quot;</span>, <span class="st">&quot;T-cells&quot;</span>, <span class="st">&quot;Myeloid&quot;</span>, <span class="st">&quot;NK&quot;</span>)</a></code></pre>
<p>Here we present results in a form of a stacked baplot where scores sum up to 1. The scores used for plot should not be used as final scores, there are just more convinient for visualization purposes.</p>
<pre class="sourceCode r" id="cb99"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw">stacked_proportions_plot</span>(<span class="kw">t</span>(weighted.scores))</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-128-1.png" /><!-- --></p>
<pre class="sourceCode r" id="cb100"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="kw">library</span>(MCPcounter)</a>
<a class="sourceLine" id="cb100-2" data-line-number="2"><span class="co">#&gt; Loading required package: curl</span></a>
<a class="sourceLine" id="cb100-3" data-line-number="3">MCP.counter.scores &lt;-<span class="st"> </span><span class="kw">MCPcounter.estimate</span>(BEK_ica_overdecompose<span class="op">$</span>counts,<span class="dt">featuresType=</span><span class="st">&quot;HUGO_symbols&quot;</span>)</a>
<a class="sourceLine" id="cb100-4" data-line-number="4"><span class="kw">stacked_proportions_plot</span>(MCP.counter.scores)</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-129-1.png" /><!-- --></p>
<pre class="sourceCode r" id="cb101"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="co">#without enothelial cells and Fibroblasts</span></a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="kw">stacked_proportions_plot</span>(MCP.counter.scores[<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">9</span>),])</a></code></pre>
<p><img src="DeconICA_introduction_files/figure-html/unnamed-chunk-130-1.png" /><!-- --></p>
<!-- ## Simulate Data  -->
<!-- TBA -->
<!-- ## Vignette Info -->
<!-- Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette. -->
<!-- ## Styles -->
<!-- The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows: -->
<!--     output:  -->
<!--       rmarkdown::html_vignette: -->
<!--         css: mystyles.css -->
<!-- ## Figures -->
<!-- The figure sizes have been customised so that you can easily put two images side-by-side.  -->
<!-- ```{r, fig.show='hold'} -->
<!-- plot(1:10) -->
<!-- plot(10:1) -->
<!-- ``` -->
<!-- You can enable figure captions by `fig_caption: yes` in YAML: -->
<!--     output: -->
<!--       rmarkdown::html_vignette: -->
<!--         fig_caption: yes -->
<!-- Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**. -->
<!-- ## More Examples -->
<!-- You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`. -->
<!-- ```{r, echo=FALSE, results='asis'} -->
<!-- knitr::kable(head(mtcars, 10)) -->
<!-- ``` -->
<!-- Also a quote using `>`: -->
<!-- > "He who gives up [code] safety for [code] speed deserves neither." -->
<!-- ([via](https://twitter.com/hadleywickham/status/504368538874703872)) -->
</div>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Abbas2009">
<p>Abbas, Alexander R., Kristen Wolslegel, Dhaya Seshasayee, Zora Modrusan, and Hilary F. Clark. 2009. ‚ÄúDeconvolution of Blood Microarray Data Identifies Cellular Activation Patterns in Systemic Lupus Erythematosus.‚Äù Edited by Patrick Tan. <em>PLoS ONE</em> 4 (7). Public Library of Science: e6098. doi:<a href="https://doi.org/10.1371/journal.pone.0006098">10.1371/journal.pone.0006098</a>.</p>
</div>
<div id="ref-Al-Ejeh2014">
<p>Al-Ejeh, F, P T Simpson, J M Sanus, K Klein, M Kalimutho, W Shi, M Miranda, et al. 2014. ‚ÄúMeta-analysis of the global gene expression profile of triple-negative breast cancer identifies genes for the prognostication and treatment of aggressive breast cancer.‚Äù <em>Oncogenesis</em> 3 (4). Nature Publishing Group: e100‚Äìe100. doi:<a href="https://doi.org/10.1038/oncsis.2014.14">10.1038/oncsis.2014.14</a>.</p>
</div>
<div id="ref-Aran2017">
<p>Aran, Dvir, Zicheng Hu, and Atul J Butte. 2017. ‚ÄúxCell: digitally portraying the tissue cellular heterogeneity landscape.‚Äù <em>Genome Biology</em> 18 (1). BioMed Central: 220. doi:<a href="https://doi.org/10.1186/s13059-017-1349-1">10.1186/s13059-017-1349-1</a>.</p>
</div>
<div id="ref-MCPcounter">
<p>Becht, Etienne, and Aurelien de Reynies. 2016. <em>MCPcounter: Estimating Tissue-Infiltrating Immune and Other Stromal Subpopulations Abundances Using Gene Expression</em>.</p>
</div>
<div id="ref-Becht2016">
<p>Becht, Etienne, Nicolas A. Giraldo, Laetitia Lacroix, B√©n√©dicte Buttard, Nabila Elarouci, Florent Petitprez, Janick Selves, et al. 2016. ‚ÄúEstimating the population abundance of tissue-infiltrating immune and stromal cell populations using gene expression.‚Äù <em>Genome Biology</em> 17 (1). doi:<a href="https://doi.org/10.1186/s13059-016-1070-5">10.1186/s13059-016-1070-5</a>.</p>
</div>
<div id="ref-Bekhouche2011">
<p>Bekhouche, Ismahane, Pascal Finetti, Jos√© Adela√Øde, Anthony Ferrari, Carole Tarpin, Emmanuelle Charafe-Jauffret, Colette Charpin, et al. 2011. ‚ÄúHigh-resolution comparative genomic hybridization of Inflammatory breast cancer and identification of candidate genes.‚Äù <em>PLoS ONE</em> 6 (2). doi:<a href="https://doi.org/10.1371/journal.pone.0016950">10.1371/journal.pone.0016950</a>.</p>
</div>
<div id="ref-Biton2014">
<p>Biton, Anne, Isabelle Bernard-Pierrot, Yinjun Lou, Cl√©mentine Krucker, Elodie Chapeaublanc, Carlota Rubio-P√©rez, Nuria L√≥pez-Bigas, et al. 2014. ‚ÄúIndependent Component Analysis Uncovers the Landscape of the Bladder Tumor Transcriptome and Reveals Insights into Luminal and Basal Subtypes.‚Äù <em>Cell Reports</em> 9 (4): 1235‚Äì45. doi:<a href="https://doi.org/10.1016/j.celrep.2014.10.035">10.1016/j.celrep.2014.10.035</a>.</p>
</div>
<div id="ref-Brunet2004">
<p>Brunet, Jean-Philippe, Pablo Tamayo, Todd R Golub, and Jill P Mesirov. 2004. ‚ÄúMetagenes and molecular pattern discovery using matrix factorization.‚Äù <em>Proceedings of the National Academy of Sciences of the United States of America</em> 101 (12). National Academy of Sciences: 4164‚Äì9. doi:<a href="https://doi.org/10.1073/pnas.0308531101">10.1073/pnas.0308531101</a>.</p>
</div>
<div id="ref-Cheng2013">
<p>Cheng, Wei-Yi, Tai-Hsien Ou Yang, and Dimitris Anastassiou. 2013. ‚ÄúBiomolecular events in cancer revealed by attractor metagenes.‚Äù Edited by Isidore Rigoutsos. <em>PLoS Computational Biology</em> 9 (2): e1002920. doi:<a href="https://doi.org/10.1371/journal.pcbi.1002920">10.1371/journal.pcbi.1002920</a>.</p>
</div>
<div id="ref-Chun-HouZheng2009">
<p>Chun-Hou Zheng, De-Shuang Huang, Lei Zhang, and Xiang-Zhen Kong. 2009. ‚ÄúTumor Clustering Using Nonnegative Matrix Factorization with Gene Selection.‚Äù <em>IEEE Transactions on Information Technology in Biomedicine</em> 13 (4): 599‚Äì607. doi:<a href="https://doi.org/10.1109/TITB.2009.2018115">10.1109/TITB.2009.2018115</a>.</p>
</div>
<div id="ref-Czerwinska2018">
<p>Czerwinska, Urszula, Laura Cantini, Ulykbek Kairov, Emmanuel Barillot, and Andrei Zinovyev. 2018. ‚ÄúApplication of Independent Component Analysis to Tumor Transcriptomes Reveals Specific And Reproducible Immune-related Signals.‚Äù <em>Springler Proceedings</em>. LVA-ICA.</p>
</div>
<div id="ref-Elmas2016">
<p>Elmas, Abdulkadir, Tai-Hsien Ou Yang, Xiaodong Wang, and Dimitris Anastassiou. 2016. ‚ÄúDiscovering Genome-Wide Tag SNPs Based on the Mutual Information of the Variants.‚Äù Edited by Srinivas Mummidi. <em>PLOS ONE</em> 11 (12). Public Library of Science: e0167994. doi:<a href="https://doi.org/10.1371/journal.pone.0167994">10.1371/journal.pone.0167994</a>.</p>
</div>
<div id="ref-NMF1">
<p>Gaujoux, Renaud, and Cathal Seoighe. 2010. ‚ÄúA Flexible R Package for Nonnegative Matrix Factorization.‚Äù <em>BMC Bioinformatics</em> 11 (1): 367. doi:<a href="https://doi.org/10.1186/1471-2105-11-367">10.1186/1471-2105-11-367</a>.</p>
</div>
<div id="ref-CellMix1">
<p>‚Äî‚Äî‚Äî. 2012. ‚ÄúCellMix: A Comprehensive Toolbox for Gene Expression Deconvolution.‚Äù <em>(Submitted)</em>. <a href="http://web.cbio.uct.ac.za/~renaud/CRAN/web/CellMix" class="uri">http://web.cbio.uct.ac.za/~renaud/CRAN/web/CellMix</a>.</p>
</div>
<div id="ref-CellMix3">
<p>‚Äî‚Äî‚Äî. 2013. <em>CellMix: Sample Analyses</em>. CRAN. <a href="http://cran.r-project.org/package=CellMix" class="uri">http://cran.r-project.org/package=CellMix</a>.</p>
</div>
<div id="ref-NMF3">
<p>‚Äî‚Äî‚Äî. 2015a. <em>The Package Nmf: Manual Pages</em>. CRAN. <a href="http://cran.r-project.org/package=NMF" class="uri">http://cran.r-project.org/package=NMF</a>.</p>
</div>
<div id="ref-NMF2">
<p>‚Äî‚Äî‚Äî. 2015b. <em>Using the Package Nmf</em>. CRAN. <a href="http://cran.r-project.org/package=NMF" class="uri">http://cran.r-project.org/package=NMF</a>.</p>
</div>
<div id="ref-Gorban2008">
<p>Gorban, A.N., K√©gl, B., Wunsch, D.C., Zinovyev, A. 2008. <em>Principal Manifolds for Data Visualization and Dimension Reduction</em>. Edited by Alexander N. Gorban, Bal√°zs K√©gl, Donald C. Wunsch, and Andrei Y. Zinovyev. Vol. 58. Lecture Notes in Computational Science and Enginee. Berlin, Heidelberg: Springer Berlin Heidelberg. doi:<a href="https://doi.org/10.1007/978-3-540-73750-6">10.1007/978-3-540-73750-6</a>.</p>
</div>
<div id="ref-Hart2015">
<p>Hart, Yuval, Hila Sheftel, Jean Hausser, Pablo Szekely, Noa Bossel Ben-Moshe, Yael Korem, Avichai Tendler, Avraham E Mayo, and Uri Alon. 2015. ‚ÄúInferring biological tasks using Pareto analysis of high-dimensional data.‚Äù <em>Nature Methods</em> 12 (3): 233‚Äì35. doi:<a href="https://doi.org/10.1038/nmeth.3254">10.1038/nmeth.3254</a>.</p>
</div>
<div id="ref-Himberg2003">
<p>Himberg, Johan, and Aapo Hyv√§rinen. 2003. ‚ÄúICASSO: Software for investigating the reliability of ICA estimates by clustering and visualization.‚Äù In <em>Neural Networks for Signal Processing - Proceedings of the Ieee Workshop</em>, 2003-Janua:259‚Äì68. doi:<a href="https://doi.org/10.1109/NNSP.2003.1318025">10.1109/NNSP.2003.1318025</a>.</p>
</div>
<div id="ref-Hyvarinen2000">
<p>Hyv√§rinen, Aapo, and Erkki Oja. 2000. ‚ÄúIndependent Component Analysis: Algorithms and Applications.‚Äù <em>Neural Networks</em> 13 (45): 411‚Äì30. doi:<a href="https://doi.org/10.1016/S0893-6080(00)00026-5">10.1016/S0893-6080(00)00026-5</a>.</p>
</div>
<div id="ref-Kairov2017">
<p>Kairov, Ulykbek, Laura Cantini, Alessandro Greco, Askhat Molkenov, Urszula Czerwinska, Emmanuel Barillot, and Andrei Zinovyev. 2017. ‚ÄúDetermining the optimal number of independent components for reproducible transcriptomic data analysis.‚Äù <em>BMC Genomics</em> 18 (1). doi:<a href="https://doi.org/10.1186/s12864-017-4112-9">10.1186/s12864-017-4112-9</a>.</p>
</div>
<div id="ref-Li2016">
<p>Li, Bo, Eric Severson, Jean-Christophe Pignon, Haoquan Zhao, Taiwen Li, Jesse Novak, Peng Jiang, et al. 2016. ‚ÄúComprehensive analyses of tumor immunity: implications for cancer immunotherapy.‚Äù <em>Genome Biology 2016 17:1</em> 29 (1). BioMed Central: 1949‚Äì55. doi:<a href="https://doi.org/10.1200/JCO.2010.30.5037">10.1200/JCO.2010.30.5037</a>.</p>
</div>
<div id="ref-Liu2017">
<p>Liu, Yuan, Yu Liang, Qifan Kuang, Fanfan Xie, Yingyi Hao, Zhining Wen, and Menglong Li. 2017. ‚ÄúPost-modified non-negative matrix factorization for deconvoluting the gene expression profiles of specific cell types from heterogeneous clinical samples based on RNA-sequencing data.‚Äù <em>Journal of Chemometrics</em>, August. Wiley-Blackwell, e2929. doi:<a href="https://doi.org/10.1002/cem.2929">10.1002/cem.2929</a>.</p>
</div>
<div id="ref-Moffitt2015">
<p>Moffitt, Richard A, Raoud Marayati, Elizabeth L Flate, Keith E Volmar, S Gabriela Herrera Loeza, Katherine A Hoadley, Naim U Rashid, et al. 2015. ‚ÄúVirtual microdissection identifies distinct tumor- and stroma-specific subtypes of pancreatic ductal adenocarcinoma.‚Äù <em>Nature Genetics</em>. doi:<a href="https://doi.org/10.1038/ng.3398">10.1038/ng.3398</a>.</p>
</div>
<div id="ref-Newberg2018">
<p>Newberg, Lee A., Xiaowei Chen, Chinnappa D. Kodira, and Maria I. Zavodszky. 2018. ‚ÄúComputational de novo discovery of distinguishing genes for biological processes and cell types in complex tissues.‚Äù Edited by Paolo Provero. <em>PLOS ONE</em> 13 (3). Public Library of Science: e0193067. doi:<a href="https://doi.org/10.1371/journal.pone.0193067">10.1371/journal.pone.0193067</a>.</p>
</div>
<div id="ref-Newman2015">
<p>Newman, Aaron M., Chih Long Liu, Michael R. Green, Andrew J. Gentles, Weiguo Feng, Yue Xu, Chuong D. Hoang, Maximilian Diehn, and Ash A. Alizadeh. 2015. ‚ÄúRobust enumeration of cell subsets from tissue expression profiles.‚Äù <em>Nature Methods</em> 12 (5): 453‚Äì57. doi:<a href="https://doi.org/10.1038/nmeth.3337">10.1038/nmeth.3337</a>.</p>
</div>
<div id="ref-Racle2017">
<p>Racle, Julien, Kaat de Jonge, Petra Baumgaertner, Daniel E Speiser, and David Gfeller. 2017. ‚ÄúSimultaneous enumeration of cancer and immune cell types from bulk tumor gene expression data.‚Äù <em>eLife</em> 6 (November). eLife Sciences Publications, Ltd. doi:<a href="https://doi.org/10.7554/eLife.26476">10.7554/eLife.26476</a>.</p>
</div>
<div id="ref-Saidi2004">
<p>Saidi, Samir A, Cathrine M Holland, David P Kreil, David J C MacKay, D Stephen Charnock-Jones, Cristin G Print, and Stephen K Smith. 2004. ‚ÄúIndependent component analysis of microarray data in the study of endometrial cancer.‚Äù <em>Oncogene</em> 23 (39). Nature Publishing Group: 6677‚Äì83. doi:<a href="https://doi.org/10.1038/sj.onc.1207562">10.1038/sj.onc.1207562</a>.</p>
</div>
<div id="ref-Schelker2017">
<p>Schelker, Max, Sonia Feau, Jinyan Du, Nav Ranu, Edda Klipp, Gavin MacBeath, Birgit Schoeberl, and Andreas Raue. 2017. ‚ÄúEstimation of immune cell content in tumour tissue using single-cell RNA-seq data.‚Äù <em>Nature Communications</em> 8 (1). Nature Publishing Group: 2032. doi:<a href="https://doi.org/10.1038/s41467-017-02289-3">10.1038/s41467-017-02289-3</a>.</p>
</div>
<div id="ref-Schwartz2010">
<p>Schwartz, Russell, and Stanley E Shackney. 2010. ‚ÄúApplying unmixing to gene expression data for tumor phylogeny inference.‚Äù <em>BMC Bioinformatics</em> 11 (1): 42. doi:<a href="https://doi.org/10.1186/1471-2105-11-42">10.1186/1471-2105-11-42</a>.</p>
</div>
<div id="ref-Teschendorff2007">
<p>Teschendorff, Andrew E, Michel Journ√©e, Pierre A Absil, Rodolphe Sepulchre, and Carlos Caldas. 2007. ‚ÄúElucidating the altered transcriptional programs in breast cancer using independent component analysis.‚Äù <em>PLoS Computational Biology</em> 3 (8). Public Library of Science: e161. doi:<a href="https://doi.org/10.1371/journal.pcbi.0030161">10.1371/journal.pcbi.0030161</a>.</p>
</div>
<div id="ref-Vallania2017">
<p>Vallania, Francesco, Andrew Tam, Shane Lofgren, Steven Schaffert, Tej D. Azad, Erika Bongen, Meia Alsup, et al. 2017. ‚ÄúLeveraging heterogeneity across multiple data sets increases accuracy of cell-mixture deconvolution and reduces biological and technical biases.‚Äù <em>bioRxiv</em>, October. Cold Spring Harbor Laboratory, 206466. doi:<a href="https://doi.org/10.1101/206466">10.1101/206466</a>.</p>
</div>
<div id="ref-Wang2016">
<p>Wang, Niya, Eric P. Hoffman, Lulu Chen, Li Chen, Zhen Zhang, Chunyu Liu, Guoqiang Yu, David M. Herrington, Robert Clarke, and Yue Wang. 2016. ‚ÄúMathematical modelling of transcriptional heterogeneity identifies novel markers and subpopulations in complex tissues.‚Äù <em>Scientific Reports</em> 6 (1). Nature Publishing Group: 18909. doi:<a href="https://doi.org/10.1038/srep18909">10.1038/srep18909</a>.</p>
</div>
<div id="ref-Yang2015">
<p>Yang, Zi, and George Michailidis. 2015. ‚ÄúA non-negative matrix factorization method for detecting modules in heterogeneous omics multi-modal data.‚Äù <em>Bioinformatics</em> 32 (1): btv544. doi:<a href="https://doi.org/10.1093/bioinformatics/btv544">10.1093/bioinformatics/btv544</a>.</p>
</div>
<div id="ref-Zinovyev2013">
<p>Zinovyev, Andrei, Ulykbek Kairov, Tatyana Karpenyuk, and Erlan Ramanculov. 2013. ‚ÄúBlind source separation methods for deconvolution of complex signals in cancer biology.‚Äù <em>Biochemical and Biophysical Research Communications</em> 430 (3): 1182‚Äì7. doi:<a href="https://doi.org/10.1016/j.bbrc.2012.12.043">10.1016/j.bbrc.2012.12.043</a>.</p>
</div>
</div>
</div>
</div>
</section>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
